{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"WhatsApp Analysis Toolkit","text":"<p>--8\u2190 \"docs/about.md\"</p>"},{"location":"#contents","title":"Contents","text":"<ul> <li>About whatstk</li> <li>Getting started</li> <li>Code examples </li> <li>API Reference</li> <li>Why choose whatstk?</li> <li>Community &amp; Governance</li> <li>Contribute</li> <li>Changelog</li> </ul>"},{"location":"about/","title":"About whatstk","text":"<p>whatstk is a python package providing tools to parse, analyze and visualize WhatsApp chats developed by Lucas Rod\u00e9s-Guirao. Easily convert your chats to csv or simply visualize statistics using the python library. The package uses pandas to process the data and plotly to visualise it.</p> <p>You can also try a live demo.</p> <p>The project is distributed under the GPL-3.0 license and is available on GitHub.</p>"},{"location":"about/#first-contact-with-whatstk","title":"First contact with whatstk","text":"<p>whatstk is built around <code>BaseChat</code> object interface, which requires class method <code>from_source</code> to be implemented. This method loads and parses the source chat file into a pandas.DataFrame.</p> <p>Below, we use method <code>df_from_whatsapp</code> to load LOREM chat. To test it with your own chat, simply export it as a txt file to your computer and then use class argument <code>filepath</code>, as shown in the following example.</p> <pre><code>&gt;&gt;&gt; from whatstk import df_from_whatsapp\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; df = df_from_whatsapp(filepath=whatsapp_urls.LOREM)\n&gt;&gt;&gt; df.head(5)\n                 date        username                                            message\n0 2020-01-15 02:22:56            Mary                     Nostrud exercitation magna id.\n1 2020-01-15 03:33:01            Mary     Non elit irure irure pariatur exercitation. \ud83c\udde9\ud83c\uddf0\n2 2020-01-15 04:18:42  +1 123 456 789  Exercitation esse lorem reprehenderit ut ex ve...\n3 2020-01-15 06:05:14        Giuseppe  Aliquip dolor reprehenderit voluptate dolore e...\n4 2020-01-15 06:56:00            Mary              Ullamco duis et commodo exercitation.\n</code></pre>"},{"location":"about/#installation-compatibility","title":"Installation &amp; compatibility","text":"<p>This project is on PyPI, install it with pip:</p> <pre><code>pip install whatstk\n</code></pre> <p>Project has been tested in Python&gt;=3.7.</p>"},{"location":"about/#from-source","title":"From source","text":"<p>Clone the project from the official repository and install it locally </p> <pre><code>git clone https://github.com/lucasrodes/whatstk.git\ncd whatstk\npip install .\n</code></pre>"},{"location":"about/#extensions","title":"Extensions","text":"<p>To use Google Drive or Chat Generation support, install the library along with the corresponding extensions:</p> <pre><code>pip install whatstk[gdrive]\n</code></pre> <pre><code>pip install whatstk[generate]\n</code></pre> <p>Or install the full suite:</p> <pre><code>pip install whatstk[full]\n</code></pre>"},{"location":"about/#develop","title":"Develop","text":"<p>You can also install the version in development directly from github develop branch. </p> <pre><code>pip install git+https://github.com/lucasrodes/whatstk.git@develop\n</code></pre> <p>Note: It requires git to be installed.</p>"},{"location":"about/#support","title":"Support","text":"<p>You can ask questions and join the development discussion on GitHub. Use the GitHub issues section to report bugs or request features and GitHub discussions to open up broader discussions. You can also check the project roadmap.</p> <p>For more details, refer to the contribute section.</p>"},{"location":"about/#why-this-name-whatstk","title":"Why this name, whatstk?","text":"<p>whatstk stands for \"WhatsApp Toolkit\", since the project was initially conceived as a python library to read and process WhatsApp chats. It currently only supports WhatsApp chats, but this might be extended in the future.</p>"},{"location":"changelog/","title":"Changelog","text":"<p>Work in Progress</p> <p>This page is under construction. For now, please refer to the GitHub releases for the changelog.</p>"},{"location":"community/","title":"Community &amp; Governance","text":"<p>whatstk is a fully open-source project done for and by the community. It is primarily developed at sociepy by the whatstk team, with the help of open-source developers.</p> <p>For library discussions, consider joining gitter group.</p>"},{"location":"community/#leadership","title":"Leadership","text":""},{"location":"community/#bdfl","title":"BDFL","text":"<p>Role: final call in decisions related to the API.</p> <ul> <li>Lucas Rod\u00e9s-Guirao</li> </ul>"},{"location":"community/#community-contributors","title":"Community Contributors","text":"<ul> <li>Albert Aparicio Isarn</li> <li>Kolmar Kafran</li> <li>Clara S\u00e1ez Calabuig (project logo)</li> </ul>"},{"location":"contribute/","title":"Contribute","text":"<p>Work in Progress</p> <p>This page is under construction. For now, please refer to the GitHub repository for contribution guidelines.</p>"},{"location":"why_whatstk/","title":"Why choose whatstk?","text":"<p>There are many python libraries to deal with WhatsApp and other platform chat files. Why should you choose whatstk over these?</p>"},{"location":"why_whatstk/#automatic-parser","title":"Automatic parser","text":"<p>In WhatsApp, the chat might be exported in different formats depending on your phone configuration, which adds complexity when parsing the chat. whatstk incorporates a reliable and powerful parser to correctly infer the structure of most of the chats. In the rare and improbable case that the automatic parser does not work for a certain chat, you can still use <code>hformat</code>.</p>"},{"location":"why_whatstk/#the-power-of-pandas-and-plotly","title":"The power of pandas and plotly","text":"<p>whatstk uses well established and mantained python libraries pandas to process the data and plotly and exploits their potential to efficiently process and create figures.</p>"},{"location":"why_whatstk/#open-source-and-community-oriented","title":"Open source and Community oriented","text":"<p>The project is distributed under the GPL-3.0 license, available on GitHub and open for user contributions.</p> <p>The project is mantained since 2016 by @lucasrodes.</p>"},{"location":"code_examples/","title":"Code Examples","text":"<p>This section contains various examples of using whatstk for different tasks.</p>"},{"location":"code_examples/#examples","title":"Examples","text":"<p>More examples are available in the getting started section.</p>"},{"location":"getting_started/","title":"Getting started","text":"<p>Getting started with the library is fairly easy.</p>"},{"location":"getting_started/#contents","title":"Contents","text":"<ul> <li>Export a WhatsApp chat from your phone</li> <li>Load a WhatsApp chat</li> <li>Command line tools</li> <li>The Header format</li> <li>Library available chats</li> </ul> <p>For examples refer to code examples section.</p> <p>For a rapid introduction, check this tutorial on Medium.</p>"},{"location":"getting_started/command_line/","title":"Command Line Tools","text":"<p>Work in Progress</p> <p>This section is being migrated from Sphinx to MkDocs. Content will be available soon.</p>"},{"location":"getting_started/export_chat/","title":"Export a WhatsApp chat","text":"<p>Exporting a WhatsApp chat can be easily done from your Android or iOS device. It is done on a chat basis, so if you want to export several chats you will have to export them individually. When exporting, make sure to select the chats Without Media option. Once generated, you can send it via mail, so you can save it in your computer.</p>"},{"location":"getting_started/export_chat/#android","title":"Android","text":"<p>The export on Android might include several files. We are only interested in the text file (i.e. <code>txt</code> extension file).</p> <p></p> <p>For more details, refer to official website.</p>"},{"location":"getting_started/export_chat/#ios","title":"iOS","text":"<p>The chat is exported as a zip, which can be easily unzipped in your computer.</p> <p></p>"},{"location":"getting_started/hformat/","title":"Header Format","text":"<p>Work in Progress</p> <p>This section is being migrated from Sphinx to MkDocs. Content will be available soon.</p>"},{"location":"getting_started/library-available-chats/","title":"Available Chats","text":"<p>Work in Progress</p> <p>This section is being migrated from Sphinx to MkDocs. Content will be available soon.</p>"},{"location":"getting_started/load_chat/","title":"Load WhatsApp chat","text":"<p>Once you have exported a chat it is time to load it in python.</p> <p>In this example we load the example LOREM chat, which is available online, using library class <code>WhatsAppChat</code>.</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n</code></pre> <p>Once loaded, we can check some of the chat messages by accessing its attribute <code>df</code>, which is a pandas.DataFrame with columns <code>date</code> index (timestamp of message), <code>username</code> (name of user sending the message) and <code>message</code> (message sent).</p> <pre><code>&gt;&gt;&gt; chat.df.head(5)\n                     date        username                                            message\n0 2020-01-15 02:22:56            Mary                     Nostrud exercitation magna id.\n1 2020-01-15 03:33:01            Mary     Non elit irure irure pariatur exercitation. \ud83c\udde9\ud83c\uddf0\n2 2020-01-15 04:18:42  +1 123 456 789  Exercitation esse lorem reprehenderit ut ex ve...\n3 2020-01-15 06:05:14        Giuseppe  Aliquip dolor reprehenderit voluptate dolore e...\n4 2020-01-15 06:56:00            Mary              Ullamco duis et commodo exercitation.\n</code></pre> <p>Getting the start and end date of the chat can give us a good overview of the chat content.</p> <pre><code>&gt;&gt;&gt; print(f\"Start date: {chat.start_date}\\nEnd date: {chat.end_date}\")\nStart date: 2020-01-15 02:22:56\nEnd date: 2020-05-11 22:32:48\n</code></pre> <p>Also, getting a list with the chat members is simple</p> <pre><code>&gt;&gt;&gt; chat.users\n['+1 123 456 789', 'Giuseppe', 'John', 'Mary']\n</code></pre> <p>See also</p> <ul> <li>Load WhatsApp chat from multiple sources</li> <li>Load WhatsApp chat from Google Drive  </li> <li>Load WhatsApp chat with specific hformat</li> </ul>"},{"location":"reference/SUMMARY/","title":"SUMMARY","text":"<ul> <li>whatstk<ul> <li>_chat</li> <li>analysis<ul> <li>interventions</li> <li>responses</li> </ul> </li> <li>data</li> <li>graph<ul> <li>base</li> <li>figures<ul> <li>boxplot</li> <li>heatmap</li> <li>sankey</li> <li>scatter</li> <li>utils</li> </ul> </li> </ul> </li> <li>scripts<ul> <li>generate_chats</li> <li>graph</li> <li>txt_to_csv</li> </ul> </li> <li>utils<ul> <li>chat_merge</li> <li>exceptions</li> <li>gdrive</li> <li>utils</li> </ul> </li> <li>whatsapp<ul> <li>assets</li> <li>auto_header</li> <li>generation</li> <li>hformat</li> <li>objects</li> <li>parser</li> </ul> </li> </ul> </li> </ul>"},{"location":"reference/whatstk/","title":"whatstk","text":"<p>Python wrapper and analysis tools for WhatsApp chats.</p> <p>This library provides a powerful wrapper for multiple Languages and OS. In addition, analytics tools are provided.</p>"},{"location":"reference/whatstk/#whatstk.FigureBuilder","title":"<code>FigureBuilder(df=None, chat=None)</code>","text":"<p>Generate a variety of figures from your loaded chat.</p> <p>Integrates feature extraction and visualization logic to automate data plots.</p> <p>Note: Either <code>df</code> or <code>chat</code> must be provided.</p> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Chat data. Atribute <code>df</code> of a chat loaded using Chat. If a value is given,                                 <code>chat</code> is ignored.</p> <code>None</code> <code>chat</code> <code>Chat</code> <p>Chat data. Object obtained when chat loaded using Chat. Required if <code>df</code> is None.</p> <code>None</code> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Chat data. Atribute <code>df</code> of a chat loaded using Chat. If a value is given,                             <code>chat</code> is ignored.</p> <code>None</code> <code>chat</code> <code>Chat</code> <p>Chat data. Object obtained when chat loaded using Chat. Required if <code>df</code> is None.</p> <code>None</code> Source code in <code>whatstk/graph/base.py</code> <pre><code>def __init__(self, df: Optional[pd.DataFrame] = None, chat: \"BaseChat\" = None) -&gt; None:\n    \"\"\"Constructor.\n\n    Args:\n        df (pandas.DataFrame, optional): Chat data. Atribute `df` of a chat loaded using Chat. If a value is given,\n                                        ``chat`` is ignored.\n        chat (Chat, optional): Chat data. Object obtained when chat loaded using Chat. Required if ``df`` is None.\n\n    \"\"\"\n    self.df = _get_df(df=df, chat=chat)\n    # Check type of df\n    _check_types(self.df)\n    self.__user_color_mapping = None\n</code></pre>"},{"location":"reference/whatstk/#whatstk.FigureBuilder.user_color_mapping","title":"<code>user_color_mapping</code>  <code>property</code> <code>writable</code>","text":"<p>Get mapping between user and color.</p> <p>Each user is assigned a color automatically, so that this color is preserved for that user in all to-be-generated plots.</p> <p>Returns:</p> Name Type Description <code>dict</code> <code>Dict[str, str]</code> <p>Mapping from username to color (rgb).</p>"},{"location":"reference/whatstk/#whatstk.FigureBuilder.usernames","title":"<code>usernames</code>  <code>property</code>","text":"<p>Get list with users available in given chat.</p> <p>Returns:</p> Name Type Description <code>list</code> <code>BaseChat</code> <p>List with usernames available in chat DataFrame.</p>"},{"location":"reference/whatstk/#whatstk.FigureBuilder.user_interventions_count_linechart","title":"<code>user_interventions_count_linechart(date_mode='date', msg_length=False, cumulative=False, all_users=False, title='User interventions count', xlabel='Date/Time')</code>","text":"<p>Plot number of user interventions over time.</p> <p>Parameters:</p> Name Type Description Default <code>date_mode</code> <code>str</code> <p>Choose mode to group interventions by. Defaults to <code>'date'</code>. Available modes                         are:</p> <pre><code>                    - ``'date'``: Grouped by particular date (year, month and day).\n                    - ``'hour'``: Grouped by hours.\n                    - ``'month'``: Grouped by months.\n                    - ``'weekday'``: Grouped by weekday (i.e. monday, tuesday, ..., sunday).\n                    - ``'hourweekday'``: Grouped by weekday and hour.\n</code></pre> <code>'date'</code> <code>msg_length</code> <code>bool</code> <p>Set to True to count the number of characters instead of number of messages                          sent.</p> <code>False</code> <code>cumulative</code> <code>bool</code> <p>Set to True to obtain commulative counts.</p> <code>False</code> <code>all_users</code> <code>bool</code> <p>Obtain number of interventions of all users combined. Defaults to False.</p> <code>False</code> <code>title</code> <code>str</code> <p>Title for plot. Defaults to \"User interventions count\".</p> <code>'User interventions count'</code> <code>xlabel</code> <code>str</code> <p>x-axis label title. Defaults to \"Date/Time\".</p> <code>'Date/Time'</code> <p>Returns:</p> Type Description <code>Figure</code> <p>plotly.graph_objs.Figure: Plotly Figure.</p> <p>..  seealso::</p> <pre><code>* :func:`get_interventions_count &lt;whatstk.analysis.get_interventions_count&gt;`\n* :func:`fig_scatter_time &lt;whatstk.graph.figures.scatter.fig_scatter_time&gt;`\n</code></pre> Example <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n&gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_interventions_count_linechart(cumulative=True)\n&gt;&gt;&gt; plot(fig)\n</code></pre> Source code in <code>whatstk/graph/base.py</code> <pre><code>def user_interventions_count_linechart(\n    self,\n    date_mode: str = \"date\",\n    msg_length: bool = False,\n    cumulative: bool = False,\n    all_users: bool = False,\n    title: str = \"User interventions count\",\n    xlabel: str = \"Date/Time\",\n) -&gt; go.Figure:\n    \"\"\"Plot number of user interventions over time.\n\n    Args:\n        date_mode (str, optional): Choose mode to group interventions by. Defaults to ``'date'``. Available modes\n                                    are:\n\n                                    - ``'date'``: Grouped by particular date (year, month and day).\n                                    - ``'hour'``: Grouped by hours.\n                                    - ``'month'``: Grouped by months.\n                                    - ``'weekday'``: Grouped by weekday (i.e. monday, tuesday, ..., sunday).\n                                    - ``'hourweekday'``: Grouped by weekday and hour.\n        msg_length (bool, optional): Set to True to count the number of characters instead of number of messages\n                                     sent.\n        cumulative (bool, optional): Set to True to obtain commulative counts.\n        all_users (bool, optional): Obtain number of interventions of all users combined. Defaults to False.\n        title (str, optional): Title for plot. Defaults to \"User interventions count\".\n        xlabel (str, optional): x-axis label title. Defaults to \"Date/Time\".\n\n    Returns:\n        plotly.graph_objs.Figure: Plotly Figure.\n\n    ..  seealso::\n\n        * :func:`get_interventions_count &lt;whatstk.analysis.get_interventions_count&gt;`\n        * :func:`fig_scatter_time &lt;whatstk.graph.figures.scatter.fig_scatter_time&gt;`\n\n    Example:\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk import WhatsAppChat\n            &gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n            &gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_interventions_count_linechart(cumulative=True)\n            &gt;&gt;&gt; plot(fig)\n\n    \"\"\"\n    counts = get_interventions_count(\n        df=self.df,\n        date_mode=date_mode,\n        msg_length=msg_length,\n        cumulative=cumulative,\n        all_users=all_users,\n    )\n    if all_users:\n        fig = fig_scatter_time(user_data=counts, title=title, xlabel=xlabel)\n    else:\n        fig = fig_scatter_time(\n            user_data=counts, username_to_color=self.user_color_mapping, title=title, xlabel=xlabel\n        )\n    return fig\n</code></pre>"},{"location":"reference/whatstk/#whatstk.FigureBuilder.user_message_responses_flow","title":"<code>user_message_responses_flow(title='Message flow')</code>","text":"<p>Get the flow of message responses.</p> <p>A response from user X to user Y happens if user X sends a message right after a message from user Y.</p> <p>Uses a Sankey diagram.</p> <p>Parameters:</p> Name Type Description Default <code>title</code> <code>str</code> <p>Title for plot. Defaults to \"Message flow\".</p> <code>'Message flow'</code> <p>Returns:</p> Type Description <code>Figure</code> <p>plotly.graph_objs.Figure: Plotly Figure.</p> <p>..  seealso::</p> <pre><code>* :func:`get_response_matrix &lt;whatstk.analysis.get_response_matrix&gt;`\n* :func:`fig_sankey &lt;whatstk.graph.figures.sankey.fig_sankey&gt;`\n</code></pre> Example <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n&gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_message_responses_flow()\n&gt;&gt;&gt; plot(fig)\n</code></pre> Source code in <code>whatstk/graph/base.py</code> <pre><code>def user_message_responses_flow(self, title: str = \"Message flow\") -&gt; go.Figure:\n    \"\"\"Get the flow of message responses.\n\n    A response from user X to user Y happens if user X sends a message right after a message from user Y.\n\n    Uses a Sankey diagram.\n\n    Args:\n        title (str, optional): Title for plot. Defaults to \"Message flow\".\n\n    Returns:\n        plotly.graph_objs.Figure: Plotly Figure.\n\n    ..  seealso::\n\n        * :func:`get_response_matrix &lt;whatstk.analysis.get_response_matrix&gt;`\n        * :func:`fig_sankey &lt;whatstk.graph.figures.sankey.fig_sankey&gt;`\n\n    Example:\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk import WhatsAppChat\n            &gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n            &gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_message_responses_flow()\n            &gt;&gt;&gt; plot(fig)\n\n    \"\"\"\n    # Get response matrix\n    responses = get_response_matrix(self.df)\n\n    # Node lists\n    label = self.usernames * 2\n    color = list(self.user_color_mapping.values()) * 2\n    # Link lists\n    n_users = len(self.usernames)\n    source = np.repeat(np.arange(n_users), n_users).tolist()\n    target = np.arange(n_users, 2 * n_users).tolist() * n_users\n    value = responses.values.flatten().tolist()\n\n    # Get figure\n    fig = fig_sankey(label=label, color=color, source=source, target=target, value=value, title=title)\n    return fig\n</code></pre>"},{"location":"reference/whatstk/#whatstk.FigureBuilder.user_message_responses_heatmap","title":"<code>user_message_responses_heatmap(norm=NORMS.ABSOLUTE, title='Response matrix')</code>","text":"<p>Get the response matrix heatmap.</p> <p>A response from user X to user Y happens if user X sends a message right after a message from user Y.</p> <p>Parameters:</p> Name Type Description Default <code>norm</code> <code>str</code> <p>Specifies the type of normalization used for reponse count. Can be:</p> <pre><code>            - ``'absolute'``: Absolute count of messages.\n            - ``'joint'``: Normalized by total number of messages sent by all users.\n            - ``'sender'``: Normalized per sender by total number of messages sent by user.\n            - ``'receiver'``: Normalized per receiver by total number of messages sent by user.\n</code></pre> <code>ABSOLUTE</code> <code>title</code> <code>str</code> <p>Title for plot. Defaults to \"Response matrix\".</p> <code>'Response matrix'</code> <p>Returns:</p> Type Description <code>Figure</code> <p>plotly.graph_objs.Figure: Plotly Figure.</p> <p>..  seealso::</p> <pre><code>* :func:`get_response_matrix &lt;whatstk.analysis.get_response_matrix&gt;`\n* :func:`fig_heatmap &lt;whatstk.graph.figures.heatmap.fig_heatmap&gt;`\n</code></pre> Example <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n&gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_message_responses_heatmap()\n&gt;&gt;&gt; plot(fig)\n</code></pre> Source code in <code>whatstk/graph/base.py</code> <pre><code>def user_message_responses_heatmap(self, norm: str = NORMS.ABSOLUTE, title: str = \"Response matrix\") -&gt; go.Figure:\n    \"\"\"Get the response matrix heatmap.\n\n    A response from user X to user Y happens if user X sends a message right after a message from user Y.\n\n    Args:\n        norm (str, optional): Specifies the type of normalization used for reponse count. Can be:\n\n                            - ``'absolute'``: Absolute count of messages.\n                            - ``'joint'``: Normalized by total number of messages sent by all users.\n                            - ``'sender'``: Normalized per sender by total number of messages sent by user.\n                            - ``'receiver'``: Normalized per receiver by total number of messages sent by user.\n        title (str, optional): Title for plot. Defaults to \"Response matrix\".\n\n    Returns:\n        plotly.graph_objs.Figure: Plotly Figure.\n\n    ..  seealso::\n\n        * :func:`get_response_matrix &lt;whatstk.analysis.get_response_matrix&gt;`\n        * :func:`fig_heatmap &lt;whatstk.graph.figures.heatmap.fig_heatmap&gt;`\n\n    Example:\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk import WhatsAppChat\n            &gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n            &gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_message_responses_heatmap()\n            &gt;&gt;&gt; plot(fig)\n\n    \"\"\"\n    # Get response matrix\n    responses = get_response_matrix(self.df, norm=norm)\n\n    # Get figure\n    fig = fig_heatmap(df_matrix=responses, title=title)\n    return fig\n</code></pre>"},{"location":"reference/whatstk/#whatstk.FigureBuilder.user_msg_length_boxplot","title":"<code>user_msg_length_boxplot(title='User message length', xlabel='User')</code>","text":"<p>Generate figure with boxplots of each user's message length.</p> <p>Parameters:</p> Name Type Description Default <code>title</code> <code>str</code> <p>Title for plot. Defaults to \"User message length\".</p> <code>'User message length'</code> <code>xlabel</code> <code>str</code> <p>x-axis label title. Defaults to \"User\".</p> <code>'User'</code> <p>Returns:</p> Name Type Description <code>dict</code> <code>Figure</code> <p>Dictionary with data and layout. Plotly compatible.</p> <p>..  seealso::</p> <pre><code>* :func:`fig_boxplot_msglen &lt;whatstk.graph.figures.boxplot.fig_boxplot_msglen&gt;`\n</code></pre> Example <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n&gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_msg_length_boxplot()\n&gt;&gt;&gt; plot(fig)\n</code></pre> Source code in <code>whatstk/graph/base.py</code> <pre><code>def user_msg_length_boxplot(self, title: str = \"User message length\", xlabel: str = \"User\") -&gt; go.Figure:\n    \"\"\"Generate figure with boxplots of each user's message length.\n\n    Args:\n        title (str, optional): Title for plot. Defaults to \"User message length\".\n        xlabel (str, optional): x-axis label title. Defaults to \"User\".\n\n    Returns:\n        dict: Dictionary with data and layout. Plotly compatible.\n\n    ..  seealso::\n\n        * :func:`fig_boxplot_msglen &lt;whatstk.graph.figures.boxplot.fig_boxplot_msglen&gt;`\n\n    Example:\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk import WhatsAppChat\n            &gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n            &gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_msg_length_boxplot()\n            &gt;&gt;&gt; plot(fig)\n\n    \"\"\"\n    fig = fig_boxplot_msglen(df=self.df, username_to_color=self.user_color_mapping, title=title, xlabel=xlabel)\n    return fig\n</code></pre>"},{"location":"reference/whatstk/#whatstk.WhatsAppChat","title":"<code>WhatsAppChat(df)</code>","text":"<p>               Bases: <code>BaseChat</code></p> <p>Load and process a WhatsApp chat file.</p> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Chat.</p> required Example <p>This simple example loads a chat using :func:<code>WhatsAppChat &lt;WhatsAppChat&gt;</code>. Once loaded, we can access its attribute :func:<code>df &lt;WhatsAppChat.df&gt;</code>, which contains the loaded chat as a DataFrame.</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk.whatsapp.objects import WhatsAppChat\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.POKEMON)\n&gt;&gt;&gt; chat.df.head(5)\n                 date     username                                            message\n0 2016-08-06 13:23:00  Ash Ketchum                                          Hey guys!\n1 2016-08-06 13:25:00        Brock              Hey Ash, good to have a common group!\n2 2016-08-06 13:30:00        Misty  Hey guys! Long time haven't heard anything fro...\n3 2016-08-06 13:45:00  Ash Ketchum  Indeed. I think having a whatsapp group nowada...\n4 2016-08-06 14:30:00        Misty                                          Definetly\n</code></pre> <p>Optionally, you can use the argument <code>extra_metadata</code> to add additional metadata to the chat:</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.POKEMON, extra_metadata=True)\n&gt;&gt;&gt; chat.name\n'Pokemon Chat'\n&gt;&gt;&gt; chat.df_system\n                 date                                            message\n0   2016-04-15 15:04:00     Messages and calls are end-to-end encrypted. N...\n&gt;&gt;&gt; chat.df.head()\n                 date     username                                            message\n0 2016-08-06 13:23:00  Ash Ketchum                                          Hey guys!\n1 2016-08-06 13:25:00        Brock              Hey Ash, good to have a common group!\n2 2016-08-06 13:30:00        Misty  Hey guys! Long time haven't heard anything fro...\n3 2016-08-06 13:45:00  Ash Ketchum  Indeed. I think having a whatsapp group nowada...\n4 2016-08-06 14:30:00        Misty                                          Definetly\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Chat.</p> required Source code in <code>whatstk/whatsapp/objects.py</code> <pre><code>def __init__(self, df: pd.DataFrame) -&gt; None:\n    \"\"\"Constructor.\n\n    Args:\n        df (pandas.DataFrame): Chat.\n\n    \"\"\"\n    super().__init__(df, platform=\"whatsapp\")\n</code></pre>"},{"location":"reference/whatstk/#whatstk.WhatsAppChat.from_source","title":"<code>from_source(filepath, extra_metadata=None, **kwargs)</code>  <code>classmethod</code>","text":"<p>Create an instance from a chat text file.</p> <p>Parameters:</p> Name Type Description Default <code>filepath</code> <code>str</code> <p>Path to the file. Accepted sources are:</p> <ul> <li>Local file, e.g. 'path/to/file.txt' or 'path/to/file.zip' (iOS).</li> <li>URL to a remote hosted file, e.g. 'http://www.url.to/file.txt'.</li> <li>Link to Google Drive file, e.g. 'gdrive://35gKKrNk-i3t05zPLyH4_P1rPdOmKW9NZ'. The format is expected   to be 'gdrive://[FILE-ID]'. Note that in order to load a file from Google Drive you first need to run   :func:<code>gdrive_init &lt;whatstk.utils.gdrive.gdrive_init&gt;</code>.</li> </ul> required <code>**kwargs</code> <code>Any</code> <p>Refer to the docs from         :func:<code>df_from_whatsapp &lt;whatstk.whatsapp.parser.df_from_whatsapp&gt;</code> for details on         additional arguments.</p> <code>{}</code> <code>extra_metadata</code> <code>bool</code> <p>This is experimental. If True, additional metadata will be added to the DataFrame.                     This includes class attributes such as chat.name, chat.df_system (DataFrame with                     only system messages). Note that this attribute only works on group chats.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>WhatsAppChat</code> <code>WhatsAppChat</code> <p>Class instance with loaded and parsed chat.</p> <p>..  seealso::</p> <pre><code>* :func:`df_from_whatsapp &lt;whatstk.whatsapp.parser.df_from_whatsapp&gt;`\n* :func:`WhatsAppChat.from_sources &lt;whatstk.WhatsAppChat.from_sources&gt;`\n</code></pre> Source code in <code>whatstk/whatsapp/objects.py</code> <pre><code>@classmethod\ndef from_source(\n    cls,\n    filepath: str,\n    extra_metadata: Optional[bool] = None,\n    **kwargs: Any  # noqa: ANN401\n) -&gt; \"WhatsAppChat\":\n    \"\"\"Create an instance from a chat text file.\n\n    Args:\n        filepath (str): Path to the file. Accepted sources are:\n\n            * Local file, e.g. 'path/to/file.txt' or 'path/to/file.zip' (iOS).\n            * URL to a remote hosted file, e.g. 'http://www.url.to/file.txt'.\n            * Link to Google Drive file, e.g. 'gdrive://35gKKrNk-i3t05zPLyH4_P1rPdOmKW9NZ'. The format is expected\n              to be 'gdrive://[FILE-ID]'. Note that in order to load a file from Google Drive you first need to run\n              :func:`gdrive_init &lt;whatstk.utils.gdrive.gdrive_init&gt;`.\n        **kwargs: Refer to the docs from\n                    :func:`df_from_whatsapp &lt;whatstk.whatsapp.parser.df_from_whatsapp&gt;` for details on\n                    additional arguments.\n        extra_metadata (bool): This is experimental. If True, additional metadata will be added to the DataFrame.\n                                This includes class attributes such as chat.name, chat.df_system (DataFrame with\n                                only system messages). Note that this attribute only works on group chats.\n\n    Returns:\n        WhatsAppChat: Class instance with loaded and parsed chat.\n\n    ..  seealso::\n\n        * :func:`df_from_whatsapp &lt;whatstk.whatsapp.parser.df_from_whatsapp&gt;`\n        * :func:`WhatsAppChat.from_sources &lt;whatstk.WhatsAppChat.from_sources&gt;`\n\n    \"\"\"\n    # Use extra metadata (label message types)\n    if extra_metadata:\n        warnings.warn(\n            (\n                \"The argument `extra_metadata` is an experimental feature that might become the default \"\n                \"in a future version. Set `extra_metadata=False` to keep current behavior. \"\n                \"The new behaviour will enables class attributes `chat.name` and `chat.df_system`. \"\n                \"Agian, this is very experimental, and has been mostly tested on iOS.\"\n            ),\n            FutureWarning,\n            stacklevel=2,\n        )\n        kwargs[\"message_type\"] = True\n    elif (extra_metadata is False) or (extra_metadata is None):\n        kwargs[\"message_type\"] = False\n    with warnings.catch_warnings():\n        warnings.simplefilter(\"ignore\")\n        df = df_from_whatsapp(filepath=filepath, **kwargs)\n\n    return cls(df)\n</code></pre>"},{"location":"reference/whatstk/#whatstk.WhatsAppChat.from_sources","title":"<code>from_sources(filepaths, auto_header=None, hformat=None, encoding='utf-8')</code>  <code>classmethod</code>","text":"<p>Load a WhatsAppChat instance from multiple sources.</p> <p>Parameters:</p> Name Type Description Default <code>filepaths</code> <code>list</code> <p>List with filepaths.</p> required <code>auto_header</code> <code>bool</code> <p>Detect header automatically (applies to all files). If None, attempts to                             perform automatic header detection for all files. If False, <code>hformat</code> is                             required.</p> <code>None</code> <code>hformat</code> <code>list</code> <p>List with the :ref:<code>header format &lt;The header format&gt;</code> to be used for each file.                         The list must be of length equal to <code>len(filenames)</code>. A valid header format                         might be '[%y-%m-%d %H:%M:%S] - %name:'.</p> <code>None</code> <code>encoding</code> <code>str</code> <p>Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).              <code>List of Python standard encodings              &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;</code>_.</p> <code>'utf-8'</code> <p>Returns:</p> Name Type Description <code>WhatsAppChat</code> <code>WhatsAppChat</code> <p>Class instance with loaded and parsed chat.</p> <p>..  seealso::</p> <pre><code>* :func:`WhatsAppChat.from_source &lt;WhatsAppChat.from_source&gt;`\n* :func:`merge_chats &lt;whatstk.utils.chat_merge.merge_chats&gt;`\n</code></pre> Example <p>Load a chat using two text files. In this example, we use sample chats (available online, see urls in source code :mod:<code>whatstk.data &lt;whatstk.data&gt;</code>).</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk.whatsapp.objects import WhatsAppChat\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; filepath_1 = whatsapp_urls.LOREM1\n&gt;&gt;&gt; filepath_2 = whatsapp_urls.LOREM2\n&gt;&gt;&gt; chat = WhatsAppChat.from_sources(filepaths=[filepath_1, filepath_2])\n&gt;&gt;&gt; chat.df.head(5)\n                 date        username                                            message\n0 2019-10-20 10:16:00            John        Laborum sed excepteur id eu cillum sunt ut.\n1 2019-10-20 11:15:00            Mary  Ad aliquip reprehenderit proident est irure mo...\n2 2019-10-20 12:16:00  +1 123 456 789  Nostrud adipiscing ex enim reprehenderit minim...\n3 2019-10-20 12:57:00  +1 123 456 789  Deserunt proident laborum exercitation ex temp...\n4 2019-10-20 17:28:00            John                Do ex dolor consequat tempor et ex.\n</code></pre> Source code in <code>whatstk/whatsapp/objects.py</code> <pre><code>@classmethod\ndef from_sources(\n    cls, filepaths: str, auto_header: Optional[bool] = None, hformat: Optional[str] = None, encoding: str = \"utf-8\"\n) -&gt; \"WhatsAppChat\":\n    \"\"\"Load a WhatsAppChat instance from multiple sources.\n\n    Args:\n        filepaths (list): List with filepaths.\n        auto_header (bool, optional): Detect header automatically (applies to all files). If None, attempts to\n                                        perform automatic header detection for all files. If False, ``hformat`` is\n                                        required.\n        hformat (list, optional): List with the :ref:`header format &lt;The header format&gt;` to be used for each file.\n                                    The list must be of length equal to ``len(filenames)``. A valid header format\n                                    might be '[%y-%m-%d %H:%M:%S] - %name:'.\n        encoding (str): Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).\n                         `List of Python standard encodings\n                         &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;`_.\n\n    Returns:\n        WhatsAppChat: Class instance with loaded and parsed chat.\n\n    ..  seealso::\n\n        * :func:`WhatsAppChat.from_source &lt;WhatsAppChat.from_source&gt;`\n        * :func:`merge_chats &lt;whatstk.utils.chat_merge.merge_chats&gt;`\n\n    Example:\n        Load a chat using two text files. In this example, we use sample chats (available online, see urls in\n        source code :mod:`whatstk.data &lt;whatstk.data&gt;`).\n\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk.whatsapp.objects import WhatsAppChat\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; filepath_1 = whatsapp_urls.LOREM1\n            &gt;&gt;&gt; filepath_2 = whatsapp_urls.LOREM2\n            &gt;&gt;&gt; chat = WhatsAppChat.from_sources(filepaths=[filepath_1, filepath_2])\n            &gt;&gt;&gt; chat.df.head(5)\n                             date        username                                            message\n            0 2019-10-20 10:16:00            John        Laborum sed excepteur id eu cillum sunt ut.\n            1 2019-10-20 11:15:00            Mary  Ad aliquip reprehenderit proident est irure mo...\n            2 2019-10-20 12:16:00  +1 123 456 789  Nostrud adipiscing ex enim reprehenderit minim...\n            3 2019-10-20 12:57:00  +1 123 456 789  Deserunt proident laborum exercitation ex temp...\n            4 2019-10-20 17:28:00            John                Do ex dolor consequat tempor et ex.\n\n    \"\"\"\n    dfs = []\n    if auto_header is None or auto_header:\n        auto_header = [True] * len(filepaths)\n    else:\n        auto_header = [False] * len(filepaths)\n    if hformat is None:\n        hformat = [None] * len(filepaths)\n    for filepath, ah, hf in zip(filepaths, auto_header, hformat):\n        chat = WhatsAppChat.from_source(filepath, auto_header=ah, hformat=hf, encoding=encoding)\n        dfs.append(chat.df)\n    df = merge_chats(dfs)\n    return cls(df)\n</code></pre>"},{"location":"reference/whatstk/#whatstk.WhatsAppChat.to_txt","title":"<code>to_txt(filepath, hformat=None, encoding='utf8')</code>","text":"<p>Export chat to a text file.</p> <p>Usefull to export the chat to different formats (i.e. using different hformats).</p> <p>Parameters:</p> Name Type Description Default <code>filepath</code> <code>str</code> <p>Name of the file to export (must be a local path).</p> required <code>hformat</code> <code>str</code> <p>Header format. Defaults to '%y-%m-%d, %H:%M - %name:'.</p> <code>None</code> <code>encoding</code> <code>str</code> <p>Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).              <code>List of Python standard encodings              &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;</code>_.</p> <code>'utf8'</code> Source code in <code>whatstk/whatsapp/objects.py</code> <pre><code>def to_txt(self, filepath: str, hformat: Optional[str] = None, encoding: str = \"utf8\") -&gt; None:\n    \"\"\"Export chat to a text file.\n\n    Usefull to export the chat to different formats (i.e. using different hformats).\n\n    Args:\n        filepath (str): Name of the file to export (must be a local path).\n        hformat (str, optional): Header format. Defaults to '%y-%m-%d, %H:%M - %name:'.\n        encoding (str, optional): Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).\n                         `List of Python standard encodings\n                         &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;`_.\n    \"\"\"\n    if not filepath.endswith(\".txt\"):\n        raise ValueError(f\"filepath {filepath} must end with .zip\")\n    if not hformat:\n        hformat = \"%y-%m-%d, %H:%M - %name:\"\n    text = _df_to_str(self.df, hformat)\n    with open(r\"{}\".format(filepath), \"w\", encoding=encoding) as f:\n        f.write(text)\n</code></pre>"},{"location":"reference/whatstk/#whatstk.WhatsAppChat.to_zip","title":"<code>to_zip(filepath, hformat=None, encoding='utf8')</code>","text":"<p>Export chat to a zip file.</p> <p>Usefull to export the chat to different formats (i.e. using different hformats).</p> <p>Parameters:</p> Name Type Description Default <code>filepath</code> <code>str</code> <p>Name of the file to export (must be a local path).</p> required <code>hformat</code> <code>str</code> <p>Header format. Defaults to '%y-%m-%d, %H:%M - %name:'.</p> <code>None</code> <code>encoding</code> <code>str</code> <p>Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).              <code>List of Python standard encodings              &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;</code>_.</p> <code>'utf8'</code> Source code in <code>whatstk/whatsapp/objects.py</code> <pre><code>def to_zip(self, filepath: str, hformat: Optional[str] = None, encoding: str = \"utf8\") -&gt; None:\n    \"\"\"Export chat to a zip file.\n\n    Usefull to export the chat to different formats (i.e. using different hformats).\n\n    Args:\n        filepath (str): Name of the file to export (must be a local path).\n        hformat (str, optional): Header format. Defaults to '%y-%m-%d, %H:%M - %name:'.\n        encoding (str, optional): Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).\n                         `List of Python standard encodings\n                         &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;`_.\n\n    \"\"\"\n    if not filepath.endswith(\".zip\"):\n        raise ValueError(f\"filepath {filepath} must end with .zip\")\n    if not hformat:\n        hformat = \"%y-%m-%d, %H:%M - %name:\"\n    text = _df_to_str(self.df, hformat)\n    text_filename = \"_chat.txt\"\n\n    # Create a temporary directory to hold the text file\n    with tempfile.TemporaryDirectory() as temp_dir:\n        text_file_path = os.path.join(temp_dir, text_filename)\n\n        # Write the string to a temporary text file\n        with open(text_file_path, 'w', encoding=encoding) as text_file:\n            text_file.write(text)\n\n        # Create a zip file and add the text file to it\n        with zipfile.ZipFile(filepath, 'w', zipfile.ZIP_DEFLATED) as zipf:\n            zipf.write(text_file_path, text_filename)\n</code></pre>"},{"location":"reference/whatstk/#whatstk.df_from_txt_whatsapp","title":"<code>df_from_txt_whatsapp(filepath, **kwargs)</code>","text":"<p>Alias for :func:<code>df_from_whatsapp &lt;whatstk.whatsapp.parser.df_from_whatsapp&gt;</code>.</p> Source code in <code>whatstk/whatsapp/parser.py</code> <pre><code>def df_from_txt_whatsapp(filepath: str, **kwargs: Any) -&gt; pd.DataFrame:  # noqa: ANN401\n    \"\"\"Alias for :func:`df_from_whatsapp &lt;whatstk.whatsapp.parser.df_from_whatsapp&gt;`.\"\"\"\n    warnings.warn(\n        \"This function is deprecated and will be removed in future versions. Use `df_from_whatsapp` instead.\",\n        FutureWarning,\n        stacklevel=2,\n    )\n    return df_from_whatsapp(filepath, **kwargs)\n</code></pre>"},{"location":"reference/whatstk/#whatstk.df_from_whatsapp","title":"<code>df_from_whatsapp(filepath, auto_header=True, hformat=None, encoding='utf-8', message_type=None)</code>","text":"<p>Load chat as a DataFrame.</p> <p>Parameters:</p> Name Type Description Default <code>filepath</code> <code>str</code> <p>Path to the file. Accepted sources are:</p> <pre><code>* Local file, e.g. 'path/to/file.txt' OR 'path/to/_chat.zip' (e.g. iOS export).\n* URL to a remote hosted file, e.g. 'http://www.url.to/file.txt'.\n* Link to Google Drive file, e.g. 'gdrive://35gKKrNk-i3t05zPLyH4_P1rPdOmKW9NZ'. The format is expected\n  to be 'gdrive://[FILE-ID]'. Note that in order to load a file from Google Drive you first need to run\n  :func:`gdrive_init &lt;whatstk.utils.gdrive.gdrive_init&gt;`.\n</code></pre> required <code>auto_header</code> <code>bool</code> <p>Detect header automatically. If False, <code>hformat</code> is required.</p> <code>True</code> <code>hformat</code> <code>str</code> <p>:ref:<code>Format of the header &lt;The header format&gt;</code>, e.g.                         <code>'[%y-%m-%d %H:%M:%S] - %name:'</code>. Use following keywords:</p> <pre><code>                    - ``'%y'``: for year (``'%Y'`` is equivalent).\n                    - ``'%m'``: for month.\n                    - ``'%d'``: for day.\n                    - ``'%H'``: for 24h-hour.\n                    - ``'%I'``: for 12h-hour.\n                    - ``'%M'``: for minutes.\n                    - ``'%S'``: for seconds.\n                    - ``'%P'``: for \"PM\"/\"AM\" or \"p.m.\"/\"a.m.\" characters.\n                    - ``'%name'``: for the username.\n\n                    Example 1: For the header '12/08/2016, 16:20 - username:' we have the\n                    ``'hformat='%d/%m/%y, %H:%M - %name:'``.\n\n                    Example 2: For the header '2016-08-12, 4:20 PM - username:' we have\n                    ``hformat='%y-%m-%d, %I:%M %P - %name:'``.\n</code></pre> <code>None</code> <code>encoding</code> <code>str</code> <p>Encoding to use for UTF when reading/writing (ex. 'utf-8').                       <code>List of Python standard encodings &lt;https://docs.python.org/3/library/codecs.                       html#standard-encodings&gt;</code>_.</p> <code>'utf-8'</code> <code>message_type</code> <code>bool</code> <p>Label for the message type. Can be 'user' or 'system', based on                             who sent the message.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>WhatsAppChat</code> <code>DataFrame</code> <p>Class instance with loaded and parsed chat.</p> Example <p>Read a chat</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import df_from_whatsapp\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; df = df_from_whatsapp(filepath=whatsapp_urls.LOREM)\n&gt;&gt;&gt; df.head(5)\n                 date        username                                            message    message_type\n0 2020-01-15 02:22:56            Mary                     Nostrud exercitation magna id.          system\n1 2020-01-15 03:33:01            Mary     Non elit irure irure pariatur exercitation. \ud83c\udde9\ud83c\uddf0            user\n2 2020-01-15 04:18:42  +1 123 456 789  Exercitation esse lorem reprehenderit ut ex ve...            user\n3 2020-01-15 06:05:14        Giuseppe  Aliquip dolor reprehenderit voluptate dolore e...            user\n4 2020-01-15 06:56:00            Mary              Ullamco duis et commodo exercitation.            user\n</code></pre> <p>Read a chat, labelling each message as 'user' or 'system'. 'system' messages are those sent by the chat itself (creation of chat, etc.)</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import df_from_whatsapp\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; df = df_from_whatsapp(filepath=whatsapp_urls.POKEMON, message_type=True)\n&gt;&gt;&gt; df.head()\n\n                 date        username                                            message    message_type\n0 2016-04-15 15:04:00    Pokemon Chat  Messages and calls are end-to-end encrypted. N...          system\n1 2016-08-06 13:23:00     Ash Ketchum                                          Hey guys!            user\n2 2016-08-06 13:25:00           Brock              Hey Ash, good to have a common group!            user\n3 2016-08-06 13:30:00           Misty  Hey guys! Long time since heard anything from you            user\n</code></pre> <p>..  seealso::</p> <pre><code>* :func:`WhatsAppChat.from_source &lt;whatstk.whatsapp.objects.WhatsAppChat.from_source&gt;`\n* :func:`extract_header_from_text &lt;whatstk.whatsapp.auto_header.extract_header_from_text&gt;`\n* :func:`gdrive_init &lt;whatstk.utils.gdrive.gdrive_init&gt;`\n</code></pre> Source code in <code>whatstk/whatsapp/parser.py</code> <pre><code>def df_from_whatsapp(\n    filepath: str,\n    auto_header: bool = True,\n    hformat: Optional[str] = None,\n    encoding: str = \"utf-8\",\n    message_type: Optional[bool] = None,\n) -&gt; pd.DataFrame:\n    \"\"\"Load chat as a DataFrame.\n\n    Args:\n        filepath (str): Path to the file. Accepted sources are:\n\n                * Local file, e.g. 'path/to/file.txt' OR 'path/to/_chat.zip' (e.g. iOS export).\n                * URL to a remote hosted file, e.g. 'http://www.url.to/file.txt'.\n                * Link to Google Drive file, e.g. 'gdrive://35gKKrNk-i3t05zPLyH4_P1rPdOmKW9NZ'. The format is expected\n                  to be 'gdrive://[FILE-ID]'. Note that in order to load a file from Google Drive you first need to run\n                  :func:`gdrive_init &lt;whatstk.utils.gdrive.gdrive_init&gt;`.\n        auto_header (bool, optional): Detect header automatically. If False, ``hformat`` is required.\n        hformat (str, optional): :ref:`Format of the header &lt;The header format&gt;`, e.g.\n                                    ``'[%y-%m-%d %H:%M:%S] - %name:'``. Use following keywords:\n\n                                    - ``'%y'``: for year (``'%Y'`` is equivalent).\n                                    - ``'%m'``: for month.\n                                    - ``'%d'``: for day.\n                                    - ``'%H'``: for 24h-hour.\n                                    - ``'%I'``: for 12h-hour.\n                                    - ``'%M'``: for minutes.\n                                    - ``'%S'``: for seconds.\n                                    - ``'%P'``: for \"PM\"/\"AM\" or \"p.m.\"/\"a.m.\" characters.\n                                    - ``'%name'``: for the username.\n\n                                    Example 1: For the header '12/08/2016, 16:20 - username:' we have the\n                                    ``'hformat='%d/%m/%y, %H:%M - %name:'``.\n\n                                    Example 2: For the header '2016-08-12, 4:20 PM - username:' we have\n                                    ``hformat='%y-%m-%d, %I:%M %P - %name:'``.\n        encoding (str, optional): Encoding to use for UTF when reading/writing (ex. 'utf-8').\n                                  `List of Python standard encodings &lt;https://docs.python.org/3/library/codecs.\n                                  html#standard-encodings&gt;`_.\n        message_type (bool, optional): Label for the message type. Can be 'user' or 'system', based on\n                                        who sent the message.\n\n    Returns:\n        WhatsAppChat: Class instance with loaded and parsed chat.\n\n    Example:\n        Read a chat\n\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk import df_from_whatsapp\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; df = df_from_whatsapp(filepath=whatsapp_urls.LOREM)\n            &gt;&gt;&gt; df.head(5)\n                             date        username                                            message    message_type\n            0 2020-01-15 02:22:56            Mary                     Nostrud exercitation magna id.          system\n            1 2020-01-15 03:33:01            Mary     Non elit irure irure pariatur exercitation. \ud83c\udde9\ud83c\uddf0            user\n            2 2020-01-15 04:18:42  +1 123 456 789  Exercitation esse lorem reprehenderit ut ex ve...            user\n            3 2020-01-15 06:05:14        Giuseppe  Aliquip dolor reprehenderit voluptate dolore e...            user\n            4 2020-01-15 06:56:00            Mary              Ullamco duis et commodo exercitation.            user\n\n        Read a chat, labelling each message as 'user' or 'system'. 'system' messages are those sent by the chat itself\n        (creation of chat, etc.)\n\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk import df_from_whatsapp\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; df = df_from_whatsapp(filepath=whatsapp_urls.POKEMON, message_type=True)\n            &gt;&gt;&gt; df.head()\n\n                             date        username                                            message    message_type\n            0 2016-04-15 15:04:00    Pokemon Chat  Messages and calls are end-to-end encrypted. N...          system\n            1 2016-08-06 13:23:00     Ash Ketchum                                          Hey guys!            user\n            2 2016-08-06 13:25:00           Brock              Hey Ash, good to have a common group!            user\n            3 2016-08-06 13:30:00           Misty  Hey guys! Long time since heard anything from you            user\n\n\n\n    ..  seealso::\n\n        * :func:`WhatsAppChat.from_source &lt;whatstk.whatsapp.objects.WhatsAppChat.from_source&gt;`\n        * :func:`extract_header_from_text &lt;whatstk.whatsapp.auto_header.extract_header_from_text&gt;`\n        * :func:`gdrive_init &lt;whatstk.utils.gdrive.gdrive_init&gt;`\n\n    \"\"\"\n    # Read local file\n    text = _str_from_file(filepath, encoding)\n\n    # Clean text from unwanted unicode characters\n    text = _clean_text(text)\n\n    # Build dataframe\n    df = _df_from_str(text, auto_header, hformat)\n\n    # Raise FutureWarning\n    if message_type is None:\n        message_type = False\n    # Add message type only if num users &gt; 2\n    if message_type:\n        warnings.warn(\n            (\n                \"The argument `extra_metadata` is an experimental feature that might become the default \"\n                \"in a future version. Set `extra_metadata=False` to keep current behavior. \"\n                \"The new behaviour will enables class attributes `chat.name` and `chat.df_system`. \"\n                \"Agian, this is very experimental, and has been mostly tested on iOS.\"\n            ),\n            FutureWarning,\n            stacklevel=2,\n        )\n        if len(set(df[\"username\"])) &gt; 2:\n            chat_name = df[\"username\"].iloc[0]\n            df[\"message_type\"] = df[\"username\"].apply(\n                lambda x: \"user\" if x != chat_name else \"system\"\n            )\n        else:\n            df[\"message_type\"] = \"user\"\n    return df\n</code></pre>"},{"location":"reference/whatstk/_chat/","title":"whatstk._chat","text":"<p>Library objects.</p>"},{"location":"reference/whatstk/_chat/#whatstk._chat.BaseChat","title":"<code>BaseChat(df, platform=None)</code>","text":"<p>Base chat object.</p> <p>Attributes:</p> Name Type Description <code>df</code> <code>DataFrame</code> <p>Chat as pandas.DataFrame.</p> <p>..  seealso::</p> <pre><code>* :func:`WhatsAppChat &lt;whatstk.whatsapp.objects.WhatsAppChat&gt;`\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Chat.</p> required <code>platform</code> <code>str</code> <p>Name of the platform, e.g. 'whatsapp'.</p> <code>None</code> Source code in <code>whatstk/_chat.py</code> <pre><code>def __init__(self, df: pd.DataFrame, platform: Optional[str] = None) -&gt; None:\n    \"\"\"Constructor.\n\n    Args:\n        df (pandas.DataFrame): Chat.\n        platform (str): Name of the platform, e.g. 'whatsapp'.\n\n    \"\"\"\n    self._df_raw = df\n    self._df, self._df_system, self._name = self._build_dfs(df.copy())\n    self._platform = platform\n</code></pre>"},{"location":"reference/whatstk/_chat/#whatstk._chat.BaseChat.df","title":"<code>df</code>  <code>property</code>","text":"<p>Chat as DataFrame.</p> <p>Returns:</p> Type Description <code>DataFrame</code> <p>pandas.DataFrame</p>"},{"location":"reference/whatstk/_chat/#whatstk._chat.BaseChat.df_system","title":"<code>df_system</code>  <code>property</code>","text":"<p>Chat as DataFrame.</p> <p>Returns:</p> Type Description <code>DataFrame</code> <p>pandas.DataFrame</p>"},{"location":"reference/whatstk/_chat/#whatstk._chat.BaseChat.end_date","title":"<code>end_date</code>  <code>property</code>","text":"<p>Chat end date.</p> <p>Returns:</p> Type Description <code>Union[str, datetime]</code> <p>datetime</p>"},{"location":"reference/whatstk/_chat/#whatstk._chat.BaseChat.is_group","title":"<code>is_group</code>  <code>property</code>","text":"<p>True if the chart is a group.</p> <p>A chat is detected as a group if it has more than 2 users (including the 'system'). Groups with one person will not be detected as groups.</p> <p>Returns:</p> Type Description <code>bool</code> <p>bool</p>"},{"location":"reference/whatstk/_chat/#whatstk._chat.BaseChat.name","title":"<code>name</code>  <code>property</code>","text":"<p>Name of the chat.</p> <p>Returns None if no name could be found. The name is extracted from the username of with the first system message in the chat.</p> <p>Returns:</p> Type Description <code>Optional[str]</code> <p>list</p>"},{"location":"reference/whatstk/_chat/#whatstk._chat.BaseChat.start_date","title":"<code>start_date</code>  <code>property</code>","text":"<p>Chat starting date.</p> <p>Returns:</p> Type Description <code>Union[str, datetime]</code> <p>datetime</p>"},{"location":"reference/whatstk/_chat/#whatstk._chat.BaseChat.users","title":"<code>users</code>  <code>property</code>","text":"<p>List with users.</p> <p>Returns:</p> Type Description <code>List[str]</code> <p>list</p>"},{"location":"reference/whatstk/_chat/#whatstk._chat.BaseChat.__len__","title":"<code>__len__()</code>","text":"<p>Number of messages.</p> <p>Returns:</p> Name Type Description <code>int</code> <code>int</code> <p>Instance length, defined as number of samples.</p> Source code in <code>whatstk/_chat.py</code> <pre><code>def __len__(self) -&gt; int:\n    \"\"\"Number of messages.\n\n    Returns:\n        int: Instance length, defined as number of samples.\n\n    \"\"\"\n    return len(self.df)\n</code></pre>"},{"location":"reference/whatstk/_chat/#whatstk._chat.BaseChat.from_source","title":"<code>from_source(**kwargs)</code>  <code>classmethod</code>","text":"<p>Load chat.</p> <p>Parameters:</p> Name Type Description Default <code>kwargs</code> <code>Any</code> <p>Specific to the child class.</p> <code>{}</code> <p>Raises:</p> Type Description <code>NotImplementedError</code> <p>Must be implemented in children.</p> <p>..  seealso::</p> <pre><code>* :func:`WhatsAppChat.from_source &lt;whatstk.WhatsAppChat.from_source&gt;`\n</code></pre> Source code in <code>whatstk/_chat.py</code> <pre><code>@classmethod\ndef from_source(cls, **kwargs: Any) -&gt; None:  # noqa: ANN401\n    \"\"\"Load chat.\n\n    Args:\n        kwargs: Specific to the child class.\n\n    Raises:\n        NotImplementedError: Must be implemented in children.\n\n    ..  seealso::\n\n        * :func:`WhatsAppChat.from_source &lt;whatstk.WhatsAppChat.from_source&gt;`\n\n    \"\"\"\n    raise NotImplementedError\n</code></pre>"},{"location":"reference/whatstk/_chat/#whatstk._chat.BaseChat.merge","title":"<code>merge(chat, rename_users=None)</code>","text":"<p>Merge current instance with <code>chat</code>.</p> <p>Parameters:</p> Name Type Description Default <code>chat</code> <code>WhatsAppChat</code> <p>Another chat.</p> required <code>rename_users</code> <code>dict</code> <p>Dictionary mapping old names to new names. Example: {'John':['Jon', 'J'], 'Ray':                  ['Raymond']} will map 'Jon' and 'J' to 'John', and 'Raymond' to 'Ray'. Note that old                  names must come as list (even if there is only one).</p> <code>None</code> <p>Returns:</p> Name Type Description <code>BaseChat</code> <code>BaseChat</code> <p>Merged chat.</p> <p>..  seealso::</p> <pre><code>* :func:`rename_users &lt;whatstk.whatsapp.objects.WhatsAppChat.rename_users&gt;`\n* :func:`merge_chats &lt;whatstk.utils.chat_merge.merge_chats&gt;`\n</code></pre> Example <p>Merging two chats can become handy when you have exported a chat in different times with your phone and hence each exported file might contain data that is unique to that file.</p> <p>In this example however, we merge files from different chats.</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk.whatsapp.objects import WhatsAppChat\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; filepath_1 = whatsapp_urls.LOREM1\n&gt;&gt;&gt; filepath_2 = whatsapp_urls.LOREM2\n&gt;&gt;&gt; chat_1 = WhatsAppChat.from_source(filepath=filepath_1)\n&gt;&gt;&gt; chat_2 = WhatsAppChat.from_source(filepath=filepath_2)\n&gt;&gt;&gt; chat = chat_1.merge(chat_2)\n</code></pre> Source code in <code>whatstk/_chat.py</code> <pre><code>def merge(self, chat: \"BaseChat\", rename_users: Optional[Dict[str, str]] = None) -&gt; \"BaseChat\":\n    \"\"\"Merge current instance with ``chat``.\n\n    Args:\n        chat (WhatsAppChat): Another chat.\n        rename_users (dict): Dictionary mapping old names to new names. Example: {'John':['Jon', 'J'], 'Ray':\n                             ['Raymond']} will map 'Jon' and 'J' to 'John', and 'Raymond' to 'Ray'. Note that old\n                             names must come as list (even if there is only one).\n\n    Returns:\n        BaseChat: Merged chat.\n\n    ..  seealso::\n\n        * :func:`rename_users &lt;whatstk.whatsapp.objects.WhatsAppChat.rename_users&gt;`\n        * :func:`merge_chats &lt;whatstk.utils.chat_merge.merge_chats&gt;`\n\n    Example:\n        Merging two chats can become handy when you have exported a chat in different times with your phone and\n        hence each exported file might contain data that is unique to that file.\n\n        In this example however, we merge files from different chats.\n\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk.whatsapp.objects import WhatsAppChat\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; filepath_1 = whatsapp_urls.LOREM1\n            &gt;&gt;&gt; filepath_2 = whatsapp_urls.LOREM2\n            &gt;&gt;&gt; chat_1 = WhatsAppChat.from_source(filepath=filepath_1)\n            &gt;&gt;&gt; chat_2 = WhatsAppChat.from_source(filepath=filepath_2)\n            &gt;&gt;&gt; chat = chat_1.merge(chat_2)\n\n    \"\"\"\n    # Can only merge from same platform\n    if self._platform != chat._platform:\n        raise ValueError(\"Both chats must come from the same platform.\")\n    # Merge\n    self_ = deepcopy(self)\n    self_._df_raw = merge_chats([self._df_raw, chat._df_raw])\n    self_._df = merge_chats([self.df, chat.df])\n    if (not self.df_system.empty) and (not chat.df_system.empty):\n        self_._df_system = merge_chats([self.df_system, chat.df_system])\n    if rename_users:\n        self_ = self_.rename_users(mapping=rename_users)\n    return self_\n</code></pre>"},{"location":"reference/whatstk/_chat/#whatstk._chat.BaseChat.rename_users","title":"<code>rename_users(mapping)</code>","text":"<p>Rename users.</p> <p>This might be needed in multiple occations:</p> <pre><code>- Change typos in user names stored in phone.\n- If a user appears multiple times with different usernames, group these under the same name (this might\n    happen when multiple chats are merged).\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>mapping</code> <code>dict</code> <p>Dictionary mapping old names to new names, example:             {'John': ['Jon', 'J'], 'Ray': ['Raymond']} will map 'Jon' and 'J' to 'John', and 'Raymond'             to 'Ray'. Note that old names must come as list (even if there is only one).</p> required <p>Returns:</p> Type Description <code>BaseChat</code> <p>pandas.DataFrame: DataFrame with users renamed according to <code>mapping</code>.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>Raised if mapping is not correct.</p> <p>Examples:</p> <p>Load LOREM2 chat and rename users <code>Maria</code> and <code>Maria2</code> to <code>Mary</code>.</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk.whatsapp.objects import WhatsAppChat\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM2)\n&gt;&gt;&gt; chat.users\n['+1 123 456 789', 'Giuseppe', 'John', 'Maria', 'Maria2']\n&gt;&gt;&gt; chat = chat.rename_users(mapping={'Mary': ['Maria', 'Maria2']})\n&gt;&gt;&gt; chat.users\n['+1 123 456 789', 'Giuseppe', 'John', 'Mary']\n</code></pre> Source code in <code>whatstk/_chat.py</code> <pre><code>def rename_users(self, mapping: Dict[str, str]) -&gt; \"BaseChat\":\n    \"\"\"Rename users.\n\n    This might be needed in multiple occations:\n\n        - Change typos in user names stored in phone.\n        - If a user appears multiple times with different usernames, group these under the same name (this might\n            happen when multiple chats are merged).\n\n    Args:\n        mapping (dict): Dictionary mapping old names to new names, example:\n                        {'John': ['Jon', 'J'], 'Ray': ['Raymond']} will map 'Jon' and 'J' to 'John', and 'Raymond'\n                        to 'Ray'. Note that old names must come as list (even if there is only one).\n\n    Returns:\n        pandas.DataFrame: DataFrame with users renamed according to `mapping`.\n\n    Raises:\n        ValueError: Raised if mapping is not correct.\n\n    Examples:\n        Load LOREM2 chat and rename users `Maria` and `Maria2` to `Mary`.\n\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk.whatsapp.objects import WhatsAppChat\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM2)\n            &gt;&gt;&gt; chat.users\n            ['+1 123 456 789', 'Giuseppe', 'John', 'Maria', 'Maria2']\n            &gt;&gt;&gt; chat = chat.rename_users(mapping={'Mary': ['Maria', 'Maria2']})\n            &gt;&gt;&gt; chat.users\n            ['+1 123 456 789', 'Giuseppe', 'John', 'Mary']\n\n    \"\"\"\n    self_ = deepcopy(self)\n    for new_name, old_names in mapping.items():\n        if not isinstance(old_names, list):\n            raise ValueError(\"Old names must come as a list of str (even if there is only one).\")\n        for old_name in old_names:\n            self_.df[COLNAMES_DF.USERNAME][self_.df[COLNAMES_DF.USERNAME] == old_name] = new_name\n    return self_\n</code></pre>"},{"location":"reference/whatstk/_chat/#whatstk._chat.BaseChat.to_csv","title":"<code>to_csv(filepath)</code>","text":"<p>Save chat as csv.</p> <p>Parameters:</p> Name Type Description Default <code>filepath</code> <code>str</code> <p>Name of file.</p> required Source code in <code>whatstk/_chat.py</code> <pre><code>def to_csv(self, filepath: str) -&gt; None:\n    \"\"\"Save chat as csv.\n\n    Args:\n        filepath (str): Name of file.\n\n    \"\"\"\n    if not filepath.endswith(\".csv\"):\n        raise ValueError(\"filepath must end with .csv\")\n    self.df.to_csv(filepath, index=False)\n</code></pre>"},{"location":"reference/whatstk/data/","title":"whatstk.data","text":"<p>Load sample chats.</p> <p>Tthis module contains the links to currently online-available chats. For more details, please refer to the source code.</p>"},{"location":"reference/whatstk/analysis/","title":"whatstk.analysis","text":"<p>Analysis tools.</p>"},{"location":"reference/whatstk/analysis/#whatstk.analysis.get_interventions_count","title":"<code>get_interventions_count(df=None, chat=None, date_mode='date', msg_length=False, cumulative=False, all_users=False)</code>","text":"<p>Get number of interventions per user per unit of time.</p> <p>The unit of time can be chosen by means of argument <code>date_mode</code>.</p> <p>Note: Either <code>df</code> or <code>chat</code> must be provided.</p> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Chat data. Atribute <code>df</code> of a chat loaded using Chat. If a value is given,                                 <code>chat</code> is ignored.</p> <code>None</code> <code>chat</code> <code>Chat</code> <p>Chat data. Object obtained when chat loaded using Chat. Required if <code>df</code> is None.</p> <code>None</code> <code>date_mode</code> <code>str</code> <p>Choose mode to group interventions by.                         Defaults to <code>date_mode=date</code>. Available modes are:</p> <pre><code>                    - ``'date'``: Grouped by particular date (year, month and day).\n                    - ``'hour'``: Grouped by day hours (24 hours).\n                    - ``'month'``: Grouped by months (12 months).\n                    - ``'weekday'``: Grouped by weekday (i.e. monday, tuesday, ..., sunday).\n                    - ``'hourweekday'``: Grouped by weekday and hour.\n</code></pre> <code>'date'</code> <code>msg_length</code> <code>bool</code> <p>Set to True to count the number of characters instead of number of messages sent.</p> <code>False</code> <code>cumulative</code> <code>bool</code> <p>Set to True to obtain commulative counts.</p> <code>False</code> <code>all_users</code> <code>bool</code> <p>Obtain number of interventions of all users combined. Defaults to False.</p> <code>False</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>pandas.DataFrame: DataFrame with shape NxU, where N: number of time-slots and U: number of users.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>if <code>date_mode</code> value is not supported.</p> Example <p>Get number of interventions per user from <code>POKEMON chat &lt;http://raw.githubusercontent.com/lucasrodes/whatstk/develop/chats/whatsapp/pokemon.txt&gt;</code>_. The counts are represented as a <code>NxU</code> matrix, where <code>N</code>: number of time-slots and <code>U</code>: number of users.</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.analysis import get_interventions_count\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; filepath = whatsapp_urls.POKEMON\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath)\n&gt;&gt;&gt; counts = get_interventions_count(chat=chat, date_mode='date', msg_length=False)\n&gt;&gt;&gt; counts.head(5)\nusername    Ash Ketchum  Brock  Jessie &amp; James  ...  Prof. Oak  Raichu  Wobbuffet\ndate                                            ...\n2016-08-06            2      2               0  ...          0       0          0\n2016-08-07            1      1               0  ...          1       0          0\n2016-08-10            1      0               1  ...          0       2          0\n2016-08-11            0      0               0  ...          0       0          0\n2016-09-11            0      0               0  ...          0       0          0\n\n[5 rows x 8 columns]\n</code></pre> Source code in <code>whatstk/analysis/interventions.py</code> <pre><code>def get_interventions_count(\n    df: pd.DataFrame = None,\n    chat: \"BaseChat\" = None,\n    date_mode: str = \"date\",\n    msg_length: bool = False,\n    cumulative: bool = False,\n    all_users: bool = False,\n) -&gt; pd.DataFrame:\n    \"\"\"Get number of interventions per user per unit of time.\n\n    The unit of time can be chosen by means of argument ``date_mode``.\n\n    **Note**: Either ``df`` or ``chat`` must be provided.\n\n    Args:\n        df (pandas.DataFrame, optional): Chat data. Atribute `df` of a chat loaded using Chat. If a value is given,\n                                            ``chat`` is ignored.\n        chat (Chat, optional): Chat data. Object obtained when chat loaded using Chat. Required if ``df`` is None.\n        date_mode (str, optional): Choose mode to group interventions by.\n                                    Defaults to ``date_mode=date``. Available modes are:\n\n                                    - ``'date'``: Grouped by particular date (year, month and day).\n                                    - ``'hour'``: Grouped by day hours (24 hours).\n                                    - ``'month'``: Grouped by months (12 months).\n                                    - ``'weekday'``: Grouped by weekday (i.e. monday, tuesday, ..., sunday).\n                                    - ``'hourweekday'``: Grouped by weekday and hour.\n        msg_length (bool, optional): Set to True to count the number of characters instead of number of messages sent.\n        cumulative (bool, optional): Set to True to obtain commulative counts.\n        all_users (bool, optional): Obtain number of interventions of all users combined. Defaults to False.\n\n    Returns:\n        pandas.DataFrame: DataFrame with shape *NxU*, where *N*: number of time-slots and *U*: number of users.\n\n    Raises:\n        ValueError: if ``date_mode`` value is not supported.\n\n    Example:\n            Get number of interventions per user from `POKEMON chat\n            &lt;http://raw.githubusercontent.com/lucasrodes/whatstk/develop/chats/whatsapp/pokemon.txt&gt;`_. The counts are\n            represented as a `NxU` matrix, where `N`: number of time-slots and `U`: number of users.\n\n            ..  code-block:: python\n\n                &gt;&gt;&gt; from whatstk import WhatsAppChat\n                &gt;&gt;&gt; from whatstk.analysis import get_interventions_count\n                &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n                &gt;&gt;&gt; filepath = whatsapp_urls.POKEMON\n                &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath)\n                &gt;&gt;&gt; counts = get_interventions_count(chat=chat, date_mode='date', msg_length=False)\n                &gt;&gt;&gt; counts.head(5)\n                username    Ash Ketchum  Brock  Jessie &amp; James  ...  Prof. Oak  Raichu  Wobbuffet\n                date                                            ...\n                2016-08-06            2      2               0  ...          0       0          0\n                2016-08-07            1      1               0  ...          1       0          0\n                2016-08-10            1      0               1  ...          0       2          0\n                2016-08-11            0      0               0  ...          0       0          0\n                2016-09-11            0      0               0  ...          0       0          0\n\n                [5 rows x 8 columns]\n\n    \"\"\"\n    df = _get_df(df=df, chat=chat)\n\n    if date_mode == \"date\":\n        n_interventions = _interventions(df, [df[COLNAMES_DF.DATE].dt.date], msg_length)\n        n_interventions.index = pd.to_datetime(n_interventions.index)\n        # print(n_interventions.shape)\n    elif date_mode == \"hour\":\n        n_interventions = _interventions(df, [df[COLNAMES_DF.DATE].dt.hour], msg_length)\n    elif date_mode == \"weekday\":\n        n_interventions = _interventions(df, [df[COLNAMES_DF.DATE].dt.weekday], msg_length)\n    elif date_mode == \"hourweekday\":\n        n_interventions = _interventions(\n            df, [df[COLNAMES_DF.DATE].dt.weekday, df[COLNAMES_DF.DATE].dt.hour], msg_length\n        )\n    elif date_mode == \"month\":\n        n_interventions = _interventions(df, [df[COLNAMES_DF.DATE].dt.month], msg_length)\n    else:\n        raise ValueError(\n            \"Mode {} is not implemented. Valid modes are 'date', 'hour', 'weekday', \"\n            \"'hourweekday' and 'month'.\".format(date_mode)\n        )\n\n    if date_mode == \"hourweekday\":\n        n_interventions.index = n_interventions.index.set_names([\"weekday\", \"hour\"])\n    else:\n        n_interventions.index.name = date_mode\n    n_interventions.columns = n_interventions.columns.get_level_values(COLNAMES_DF.USERNAME)\n\n    if all_users:\n        n_interventions = pd.DataFrame(n_interventions.sum(axis=1), columns=[\"interventions count\"])\n    if cumulative:\n        n_interventions = n_interventions.cumsum()\n\n    return n_interventions\n</code></pre>"},{"location":"reference/whatstk/analysis/#whatstk.analysis.get_response_matrix","title":"<code>get_response_matrix(df=None, chat=None, zero_own=True, norm=NORMS.ABSOLUTE)</code>","text":"<p>Get response matrix for given chat.</p> <p>Obtains a DataFrame of shape <code>[n_users, n_users]</code> counting the number of responses between members. Responses can be counted in different ways, e.g. using absolute values or normalised values. Responses are counted based solely on consecutive messages. That is, if :math:<code>user_i</code> sends a message right after :math:<code>user_j</code>, it will be counted as a response from :math:<code>user_i</code> to :math:<code>user_j</code>.</p> <p>Axis 0 lists senders and axis 1 lists receivers. That is, the value in cell (i, j) denotes the number of times :math:<code>user_i</code> responded to a message from :math:<code>user_j</code>.</p> <p>Note: Either <code>df</code> or <code>chat</code> must be provided.</p> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Chat data. Atribute <code>df</code> of a chat loaded using Chat. If a value is given,                                 <code>chat</code> is ignored.</p> <code>None</code> <code>chat</code> <code>Chat</code> <p>Chat data. Object obtained when chat loaded using Chat. Required if <code>df</code> is None.</p> <code>None</code> <code>zero_own</code> <code>bool</code> <p>Set to True to avoid counting own responses. Defaults to True.</p> <code>True</code> <code>norm</code> <code>str</code> <p>Specifies the type of normalization used for reponse count. Can be:</p> <pre><code>                - ``'absolute'``: Absolute count of messages.\n                - ``'joint'``: Normalized by total number of messages sent by all users.\n                - ``'sender'``: Normalized per sender by total number of messages sent by user.\n                - ``'receiver'``: Normalized per receiver by total number of messages sent by user.\n</code></pre> <code>ABSOLUTE</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>pandas.DataFrame: Response matrix.</p> Example <p>Get absolute count on responses (consecutive messages) between users.</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.analysis import get_response_matrix\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.POKEMON)\n&gt;&gt;&gt; responses = get_response_matrix(chat=chat)\n&gt;&gt;&gt; responses\n                Ash Ketchum  Brock  ...  Raichu  Wobbuffet\nAsh Ketchum               0      0  ...       1          0\nBrock                     1      0  ...       0          0\nJessie &amp; James            0      1  ...       0          0\nMeowth                    0      0  ...       0          0\nMisty                     2      1  ...       1          0\nProf. Oak                 0      1  ...       0          0\nRaichu                    1      0  ...       0          0\nWobbuffet                 0      0  ...       0          0\n</code></pre> Source code in <code>whatstk/analysis/responses.py</code> <pre><code>def get_response_matrix(\n    df: Optional[pd.DataFrame] = None,\n    chat: Optional[\"BaseChat\"] = None,\n    zero_own: bool = True,\n    norm: str = NORMS.ABSOLUTE,\n) -&gt; pd.DataFrame:\n    \"\"\"Get response matrix for given chat.\n\n    Obtains a DataFrame of shape `[n_users, n_users]` counting the number of responses between members. Responses can\n    be counted in different ways, e.g. using absolute values or normalised values. Responses are counted based solely\n    on consecutive messages. That is, if :math:`user_i` sends a message right after :math:`user_j`, it will be counted\n    as a response from :math:`user_i` to :math:`user_j`.\n\n    Axis 0 lists senders and axis 1 lists receivers. That is, the value in cell (i, j) denotes the number of times\n    :math:`user_i` responded to a message from :math:`user_j`.\n\n    **Note**: Either ``df`` or ``chat`` must be provided.\n\n    Args:\n        df (pandas.DataFrame, optional): Chat data. Atribute `df` of a chat loaded using Chat. If a value is given,\n                                            ``chat`` is ignored.\n        chat (Chat, optional): Chat data. Object obtained when chat loaded using Chat. Required if ``df`` is None.\n        zero_own (bool, optional): Set to True to avoid counting own responses. Defaults to True.\n        norm (str, optional): Specifies the type of normalization used for reponse count. Can be:\n\n                                - ``'absolute'``: Absolute count of messages.\n                                - ``'joint'``: Normalized by total number of messages sent by all users.\n                                - ``'sender'``: Normalized per sender by total number of messages sent by user.\n                                - ``'receiver'``: Normalized per receiver by total number of messages sent by user.\n\n    Returns:\n        pandas.DataFrame: Response matrix.\n\n    Example:\n            Get absolute count on responses (consecutive messages) between users.\n\n            ..  code-block:: python\n\n                &gt;&gt;&gt; from whatstk import WhatsAppChat\n                &gt;&gt;&gt; from whatstk.analysis import get_response_matrix\n                &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n                &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.POKEMON)\n                &gt;&gt;&gt; responses = get_response_matrix(chat=chat)\n                &gt;&gt;&gt; responses\n                                Ash Ketchum  Brock  ...  Raichu  Wobbuffet\n                Ash Ketchum               0      0  ...       1          0\n                Brock                     1      0  ...       0          0\n                Jessie &amp; James            0      1  ...       0          0\n                Meowth                    0      0  ...       0          0\n                Misty                     2      1  ...       1          0\n                Prof. Oak                 0      1  ...       0          0\n                Raichu                    1      0  ...       0          0\n                Wobbuffet                 0      0  ...       0          0\n\n    \"\"\"\n    # Get chat df and users\n    df = _get_df(df=df, chat=chat)\n    users = WhatsAppChat(df).users\n    # Get list of username transitions and initialize dicitonary with counts\n    user_transitions = df[COLNAMES_DF.USERNAME].tolist()\n    responses = {user: dict(zip(users, [0] * len(users))) for user in users}\n    # Fill count dictionary\n    for i in range(1, len(user_transitions)):\n        sender = user_transitions[i]\n        receiver = user_transitions[i - 1]\n        if zero_own and (sender != receiver):\n            responses[sender][receiver] += 1\n        elif not zero_own:\n            responses[sender][receiver] += 1\n    responses = pd.DataFrame.from_dict(responses, orient=\"index\")\n\n    # Normalize\n    if norm not in [NORMS.ABSOLUTE, NORMS.JOINT, NORMS.RECEIVER, NORMS.SENDER]:\n        raise ValueError(\"norm not valid. See NORMS variable in whatstk.analysis.resposes\")\n    else:\n        if norm == NORMS.JOINT:\n            responses /= responses.sum().sum()\n        elif norm == NORMS.RECEIVER:\n            responses /= responses.sum(axis=0)\n        elif norm == NORMS.SENDER:\n            responses = responses.divide(responses.sum(axis=1), axis=0)\n    return responses\n</code></pre>"},{"location":"reference/whatstk/analysis/interventions/","title":"whatstk.analysis.interventions","text":"<p>Base analysis tools.</p>"},{"location":"reference/whatstk/analysis/interventions/#whatstk.analysis.interventions.get_interventions_count","title":"<code>get_interventions_count(df=None, chat=None, date_mode='date', msg_length=False, cumulative=False, all_users=False)</code>","text":"<p>Get number of interventions per user per unit of time.</p> <p>The unit of time can be chosen by means of argument <code>date_mode</code>.</p> <p>Note: Either <code>df</code> or <code>chat</code> must be provided.</p> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Chat data. Atribute <code>df</code> of a chat loaded using Chat. If a value is given,                                 <code>chat</code> is ignored.</p> <code>None</code> <code>chat</code> <code>Chat</code> <p>Chat data. Object obtained when chat loaded using Chat. Required if <code>df</code> is None.</p> <code>None</code> <code>date_mode</code> <code>str</code> <p>Choose mode to group interventions by.                         Defaults to <code>date_mode=date</code>. Available modes are:</p> <pre><code>                    - ``'date'``: Grouped by particular date (year, month and day).\n                    - ``'hour'``: Grouped by day hours (24 hours).\n                    - ``'month'``: Grouped by months (12 months).\n                    - ``'weekday'``: Grouped by weekday (i.e. monday, tuesday, ..., sunday).\n                    - ``'hourweekday'``: Grouped by weekday and hour.\n</code></pre> <code>'date'</code> <code>msg_length</code> <code>bool</code> <p>Set to True to count the number of characters instead of number of messages sent.</p> <code>False</code> <code>cumulative</code> <code>bool</code> <p>Set to True to obtain commulative counts.</p> <code>False</code> <code>all_users</code> <code>bool</code> <p>Obtain number of interventions of all users combined. Defaults to False.</p> <code>False</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>pandas.DataFrame: DataFrame with shape NxU, where N: number of time-slots and U: number of users.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>if <code>date_mode</code> value is not supported.</p> Example <p>Get number of interventions per user from <code>POKEMON chat &lt;http://raw.githubusercontent.com/lucasrodes/whatstk/develop/chats/whatsapp/pokemon.txt&gt;</code>_. The counts are represented as a <code>NxU</code> matrix, where <code>N</code>: number of time-slots and <code>U</code>: number of users.</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.analysis import get_interventions_count\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; filepath = whatsapp_urls.POKEMON\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath)\n&gt;&gt;&gt; counts = get_interventions_count(chat=chat, date_mode='date', msg_length=False)\n&gt;&gt;&gt; counts.head(5)\nusername    Ash Ketchum  Brock  Jessie &amp; James  ...  Prof. Oak  Raichu  Wobbuffet\ndate                                            ...\n2016-08-06            2      2               0  ...          0       0          0\n2016-08-07            1      1               0  ...          1       0          0\n2016-08-10            1      0               1  ...          0       2          0\n2016-08-11            0      0               0  ...          0       0          0\n2016-09-11            0      0               0  ...          0       0          0\n\n[5 rows x 8 columns]\n</code></pre> Source code in <code>whatstk/analysis/interventions.py</code> <pre><code>def get_interventions_count(\n    df: pd.DataFrame = None,\n    chat: \"BaseChat\" = None,\n    date_mode: str = \"date\",\n    msg_length: bool = False,\n    cumulative: bool = False,\n    all_users: bool = False,\n) -&gt; pd.DataFrame:\n    \"\"\"Get number of interventions per user per unit of time.\n\n    The unit of time can be chosen by means of argument ``date_mode``.\n\n    **Note**: Either ``df`` or ``chat`` must be provided.\n\n    Args:\n        df (pandas.DataFrame, optional): Chat data. Atribute `df` of a chat loaded using Chat. If a value is given,\n                                            ``chat`` is ignored.\n        chat (Chat, optional): Chat data. Object obtained when chat loaded using Chat. Required if ``df`` is None.\n        date_mode (str, optional): Choose mode to group interventions by.\n                                    Defaults to ``date_mode=date``. Available modes are:\n\n                                    - ``'date'``: Grouped by particular date (year, month and day).\n                                    - ``'hour'``: Grouped by day hours (24 hours).\n                                    - ``'month'``: Grouped by months (12 months).\n                                    - ``'weekday'``: Grouped by weekday (i.e. monday, tuesday, ..., sunday).\n                                    - ``'hourweekday'``: Grouped by weekday and hour.\n        msg_length (bool, optional): Set to True to count the number of characters instead of number of messages sent.\n        cumulative (bool, optional): Set to True to obtain commulative counts.\n        all_users (bool, optional): Obtain number of interventions of all users combined. Defaults to False.\n\n    Returns:\n        pandas.DataFrame: DataFrame with shape *NxU*, where *N*: number of time-slots and *U*: number of users.\n\n    Raises:\n        ValueError: if ``date_mode`` value is not supported.\n\n    Example:\n            Get number of interventions per user from `POKEMON chat\n            &lt;http://raw.githubusercontent.com/lucasrodes/whatstk/develop/chats/whatsapp/pokemon.txt&gt;`_. The counts are\n            represented as a `NxU` matrix, where `N`: number of time-slots and `U`: number of users.\n\n            ..  code-block:: python\n\n                &gt;&gt;&gt; from whatstk import WhatsAppChat\n                &gt;&gt;&gt; from whatstk.analysis import get_interventions_count\n                &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n                &gt;&gt;&gt; filepath = whatsapp_urls.POKEMON\n                &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath)\n                &gt;&gt;&gt; counts = get_interventions_count(chat=chat, date_mode='date', msg_length=False)\n                &gt;&gt;&gt; counts.head(5)\n                username    Ash Ketchum  Brock  Jessie &amp; James  ...  Prof. Oak  Raichu  Wobbuffet\n                date                                            ...\n                2016-08-06            2      2               0  ...          0       0          0\n                2016-08-07            1      1               0  ...          1       0          0\n                2016-08-10            1      0               1  ...          0       2          0\n                2016-08-11            0      0               0  ...          0       0          0\n                2016-09-11            0      0               0  ...          0       0          0\n\n                [5 rows x 8 columns]\n\n    \"\"\"\n    df = _get_df(df=df, chat=chat)\n\n    if date_mode == \"date\":\n        n_interventions = _interventions(df, [df[COLNAMES_DF.DATE].dt.date], msg_length)\n        n_interventions.index = pd.to_datetime(n_interventions.index)\n        # print(n_interventions.shape)\n    elif date_mode == \"hour\":\n        n_interventions = _interventions(df, [df[COLNAMES_DF.DATE].dt.hour], msg_length)\n    elif date_mode == \"weekday\":\n        n_interventions = _interventions(df, [df[COLNAMES_DF.DATE].dt.weekday], msg_length)\n    elif date_mode == \"hourweekday\":\n        n_interventions = _interventions(\n            df, [df[COLNAMES_DF.DATE].dt.weekday, df[COLNAMES_DF.DATE].dt.hour], msg_length\n        )\n    elif date_mode == \"month\":\n        n_interventions = _interventions(df, [df[COLNAMES_DF.DATE].dt.month], msg_length)\n    else:\n        raise ValueError(\n            \"Mode {} is not implemented. Valid modes are 'date', 'hour', 'weekday', \"\n            \"'hourweekday' and 'month'.\".format(date_mode)\n        )\n\n    if date_mode == \"hourweekday\":\n        n_interventions.index = n_interventions.index.set_names([\"weekday\", \"hour\"])\n    else:\n        n_interventions.index.name = date_mode\n    n_interventions.columns = n_interventions.columns.get_level_values(COLNAMES_DF.USERNAME)\n\n    if all_users:\n        n_interventions = pd.DataFrame(n_interventions.sum(axis=1), columns=[\"interventions count\"])\n    if cumulative:\n        n_interventions = n_interventions.cumsum()\n\n    return n_interventions\n</code></pre>"},{"location":"reference/whatstk/analysis/responses/","title":"whatstk.analysis.responses","text":"<p>Get infor regarding responses between users.</p>"},{"location":"reference/whatstk/analysis/responses/#whatstk.analysis.responses.get_response_matrix","title":"<code>get_response_matrix(df=None, chat=None, zero_own=True, norm=NORMS.ABSOLUTE)</code>","text":"<p>Get response matrix for given chat.</p> <p>Obtains a DataFrame of shape <code>[n_users, n_users]</code> counting the number of responses between members. Responses can be counted in different ways, e.g. using absolute values or normalised values. Responses are counted based solely on consecutive messages. That is, if :math:<code>user_i</code> sends a message right after :math:<code>user_j</code>, it will be counted as a response from :math:<code>user_i</code> to :math:<code>user_j</code>.</p> <p>Axis 0 lists senders and axis 1 lists receivers. That is, the value in cell (i, j) denotes the number of times :math:<code>user_i</code> responded to a message from :math:<code>user_j</code>.</p> <p>Note: Either <code>df</code> or <code>chat</code> must be provided.</p> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Chat data. Atribute <code>df</code> of a chat loaded using Chat. If a value is given,                                 <code>chat</code> is ignored.</p> <code>None</code> <code>chat</code> <code>Chat</code> <p>Chat data. Object obtained when chat loaded using Chat. Required if <code>df</code> is None.</p> <code>None</code> <code>zero_own</code> <code>bool</code> <p>Set to True to avoid counting own responses. Defaults to True.</p> <code>True</code> <code>norm</code> <code>str</code> <p>Specifies the type of normalization used for reponse count. Can be:</p> <pre><code>                - ``'absolute'``: Absolute count of messages.\n                - ``'joint'``: Normalized by total number of messages sent by all users.\n                - ``'sender'``: Normalized per sender by total number of messages sent by user.\n                - ``'receiver'``: Normalized per receiver by total number of messages sent by user.\n</code></pre> <code>ABSOLUTE</code> <p>Returns:</p> Type Description <code>DataFrame</code> <p>pandas.DataFrame: Response matrix.</p> Example <p>Get absolute count on responses (consecutive messages) between users.</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.analysis import get_response_matrix\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.POKEMON)\n&gt;&gt;&gt; responses = get_response_matrix(chat=chat)\n&gt;&gt;&gt; responses\n                Ash Ketchum  Brock  ...  Raichu  Wobbuffet\nAsh Ketchum               0      0  ...       1          0\nBrock                     1      0  ...       0          0\nJessie &amp; James            0      1  ...       0          0\nMeowth                    0      0  ...       0          0\nMisty                     2      1  ...       1          0\nProf. Oak                 0      1  ...       0          0\nRaichu                    1      0  ...       0          0\nWobbuffet                 0      0  ...       0          0\n</code></pre> Source code in <code>whatstk/analysis/responses.py</code> <pre><code>def get_response_matrix(\n    df: Optional[pd.DataFrame] = None,\n    chat: Optional[\"BaseChat\"] = None,\n    zero_own: bool = True,\n    norm: str = NORMS.ABSOLUTE,\n) -&gt; pd.DataFrame:\n    \"\"\"Get response matrix for given chat.\n\n    Obtains a DataFrame of shape `[n_users, n_users]` counting the number of responses between members. Responses can\n    be counted in different ways, e.g. using absolute values or normalised values. Responses are counted based solely\n    on consecutive messages. That is, if :math:`user_i` sends a message right after :math:`user_j`, it will be counted\n    as a response from :math:`user_i` to :math:`user_j`.\n\n    Axis 0 lists senders and axis 1 lists receivers. That is, the value in cell (i, j) denotes the number of times\n    :math:`user_i` responded to a message from :math:`user_j`.\n\n    **Note**: Either ``df`` or ``chat`` must be provided.\n\n    Args:\n        df (pandas.DataFrame, optional): Chat data. Atribute `df` of a chat loaded using Chat. If a value is given,\n                                            ``chat`` is ignored.\n        chat (Chat, optional): Chat data. Object obtained when chat loaded using Chat. Required if ``df`` is None.\n        zero_own (bool, optional): Set to True to avoid counting own responses. Defaults to True.\n        norm (str, optional): Specifies the type of normalization used for reponse count. Can be:\n\n                                - ``'absolute'``: Absolute count of messages.\n                                - ``'joint'``: Normalized by total number of messages sent by all users.\n                                - ``'sender'``: Normalized per sender by total number of messages sent by user.\n                                - ``'receiver'``: Normalized per receiver by total number of messages sent by user.\n\n    Returns:\n        pandas.DataFrame: Response matrix.\n\n    Example:\n            Get absolute count on responses (consecutive messages) between users.\n\n            ..  code-block:: python\n\n                &gt;&gt;&gt; from whatstk import WhatsAppChat\n                &gt;&gt;&gt; from whatstk.analysis import get_response_matrix\n                &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n                &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.POKEMON)\n                &gt;&gt;&gt; responses = get_response_matrix(chat=chat)\n                &gt;&gt;&gt; responses\n                                Ash Ketchum  Brock  ...  Raichu  Wobbuffet\n                Ash Ketchum               0      0  ...       1          0\n                Brock                     1      0  ...       0          0\n                Jessie &amp; James            0      1  ...       0          0\n                Meowth                    0      0  ...       0          0\n                Misty                     2      1  ...       1          0\n                Prof. Oak                 0      1  ...       0          0\n                Raichu                    1      0  ...       0          0\n                Wobbuffet                 0      0  ...       0          0\n\n    \"\"\"\n    # Get chat df and users\n    df = _get_df(df=df, chat=chat)\n    users = WhatsAppChat(df).users\n    # Get list of username transitions and initialize dicitonary with counts\n    user_transitions = df[COLNAMES_DF.USERNAME].tolist()\n    responses = {user: dict(zip(users, [0] * len(users))) for user in users}\n    # Fill count dictionary\n    for i in range(1, len(user_transitions)):\n        sender = user_transitions[i]\n        receiver = user_transitions[i - 1]\n        if zero_own and (sender != receiver):\n            responses[sender][receiver] += 1\n        elif not zero_own:\n            responses[sender][receiver] += 1\n    responses = pd.DataFrame.from_dict(responses, orient=\"index\")\n\n    # Normalize\n    if norm not in [NORMS.ABSOLUTE, NORMS.JOINT, NORMS.RECEIVER, NORMS.SENDER]:\n        raise ValueError(\"norm not valid. See NORMS variable in whatstk.analysis.resposes\")\n    else:\n        if norm == NORMS.JOINT:\n            responses /= responses.sum().sum()\n        elif norm == NORMS.RECEIVER:\n            responses /= responses.sum(axis=0)\n        elif norm == NORMS.SENDER:\n            responses = responses.divide(responses.sum(axis=1), axis=0)\n    return responses\n</code></pre>"},{"location":"reference/whatstk/graph/","title":"whatstk.graph","text":"<p>Plot tools using plotly.</p> <p>Import :func:<code>plot &lt;whatstk.graph.plot&gt;</code> to plot figures.</p> <p>..  code-block:: python         &gt;&gt;&gt; from whatstk.graph import plot</p>"},{"location":"reference/whatstk/graph/#whatstk.graph.FigureBuilder","title":"<code>FigureBuilder(df=None, chat=None)</code>","text":"<p>Generate a variety of figures from your loaded chat.</p> <p>Integrates feature extraction and visualization logic to automate data plots.</p> <p>Note: Either <code>df</code> or <code>chat</code> must be provided.</p> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Chat data. Atribute <code>df</code> of a chat loaded using Chat. If a value is given,                                 <code>chat</code> is ignored.</p> <code>None</code> <code>chat</code> <code>Chat</code> <p>Chat data. Object obtained when chat loaded using Chat. Required if <code>df</code> is None.</p> <code>None</code> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Chat data. Atribute <code>df</code> of a chat loaded using Chat. If a value is given,                             <code>chat</code> is ignored.</p> <code>None</code> <code>chat</code> <code>Chat</code> <p>Chat data. Object obtained when chat loaded using Chat. Required if <code>df</code> is None.</p> <code>None</code> Source code in <code>whatstk/graph/base.py</code> <pre><code>def __init__(self, df: Optional[pd.DataFrame] = None, chat: \"BaseChat\" = None) -&gt; None:\n    \"\"\"Constructor.\n\n    Args:\n        df (pandas.DataFrame, optional): Chat data. Atribute `df` of a chat loaded using Chat. If a value is given,\n                                        ``chat`` is ignored.\n        chat (Chat, optional): Chat data. Object obtained when chat loaded using Chat. Required if ``df`` is None.\n\n    \"\"\"\n    self.df = _get_df(df=df, chat=chat)\n    # Check type of df\n    _check_types(self.df)\n    self.__user_color_mapping = None\n</code></pre>"},{"location":"reference/whatstk/graph/#whatstk.graph.FigureBuilder.user_color_mapping","title":"<code>user_color_mapping</code>  <code>property</code> <code>writable</code>","text":"<p>Get mapping between user and color.</p> <p>Each user is assigned a color automatically, so that this color is preserved for that user in all to-be-generated plots.</p> <p>Returns:</p> Name Type Description <code>dict</code> <code>Dict[str, str]</code> <p>Mapping from username to color (rgb).</p>"},{"location":"reference/whatstk/graph/#whatstk.graph.FigureBuilder.usernames","title":"<code>usernames</code>  <code>property</code>","text":"<p>Get list with users available in given chat.</p> <p>Returns:</p> Name Type Description <code>list</code> <code>BaseChat</code> <p>List with usernames available in chat DataFrame.</p>"},{"location":"reference/whatstk/graph/#whatstk.graph.FigureBuilder.user_interventions_count_linechart","title":"<code>user_interventions_count_linechart(date_mode='date', msg_length=False, cumulative=False, all_users=False, title='User interventions count', xlabel='Date/Time')</code>","text":"<p>Plot number of user interventions over time.</p> <p>Parameters:</p> Name Type Description Default <code>date_mode</code> <code>str</code> <p>Choose mode to group interventions by. Defaults to <code>'date'</code>. Available modes                         are:</p> <pre><code>                    - ``'date'``: Grouped by particular date (year, month and day).\n                    - ``'hour'``: Grouped by hours.\n                    - ``'month'``: Grouped by months.\n                    - ``'weekday'``: Grouped by weekday (i.e. monday, tuesday, ..., sunday).\n                    - ``'hourweekday'``: Grouped by weekday and hour.\n</code></pre> <code>'date'</code> <code>msg_length</code> <code>bool</code> <p>Set to True to count the number of characters instead of number of messages                          sent.</p> <code>False</code> <code>cumulative</code> <code>bool</code> <p>Set to True to obtain commulative counts.</p> <code>False</code> <code>all_users</code> <code>bool</code> <p>Obtain number of interventions of all users combined. Defaults to False.</p> <code>False</code> <code>title</code> <code>str</code> <p>Title for plot. Defaults to \"User interventions count\".</p> <code>'User interventions count'</code> <code>xlabel</code> <code>str</code> <p>x-axis label title. Defaults to \"Date/Time\".</p> <code>'Date/Time'</code> <p>Returns:</p> Type Description <code>Figure</code> <p>plotly.graph_objs.Figure: Plotly Figure.</p> <p>..  seealso::</p> <pre><code>* :func:`get_interventions_count &lt;whatstk.analysis.get_interventions_count&gt;`\n* :func:`fig_scatter_time &lt;whatstk.graph.figures.scatter.fig_scatter_time&gt;`\n</code></pre> Example <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n&gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_interventions_count_linechart(cumulative=True)\n&gt;&gt;&gt; plot(fig)\n</code></pre> Source code in <code>whatstk/graph/base.py</code> <pre><code>def user_interventions_count_linechart(\n    self,\n    date_mode: str = \"date\",\n    msg_length: bool = False,\n    cumulative: bool = False,\n    all_users: bool = False,\n    title: str = \"User interventions count\",\n    xlabel: str = \"Date/Time\",\n) -&gt; go.Figure:\n    \"\"\"Plot number of user interventions over time.\n\n    Args:\n        date_mode (str, optional): Choose mode to group interventions by. Defaults to ``'date'``. Available modes\n                                    are:\n\n                                    - ``'date'``: Grouped by particular date (year, month and day).\n                                    - ``'hour'``: Grouped by hours.\n                                    - ``'month'``: Grouped by months.\n                                    - ``'weekday'``: Grouped by weekday (i.e. monday, tuesday, ..., sunday).\n                                    - ``'hourweekday'``: Grouped by weekday and hour.\n        msg_length (bool, optional): Set to True to count the number of characters instead of number of messages\n                                     sent.\n        cumulative (bool, optional): Set to True to obtain commulative counts.\n        all_users (bool, optional): Obtain number of interventions of all users combined. Defaults to False.\n        title (str, optional): Title for plot. Defaults to \"User interventions count\".\n        xlabel (str, optional): x-axis label title. Defaults to \"Date/Time\".\n\n    Returns:\n        plotly.graph_objs.Figure: Plotly Figure.\n\n    ..  seealso::\n\n        * :func:`get_interventions_count &lt;whatstk.analysis.get_interventions_count&gt;`\n        * :func:`fig_scatter_time &lt;whatstk.graph.figures.scatter.fig_scatter_time&gt;`\n\n    Example:\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk import WhatsAppChat\n            &gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n            &gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_interventions_count_linechart(cumulative=True)\n            &gt;&gt;&gt; plot(fig)\n\n    \"\"\"\n    counts = get_interventions_count(\n        df=self.df,\n        date_mode=date_mode,\n        msg_length=msg_length,\n        cumulative=cumulative,\n        all_users=all_users,\n    )\n    if all_users:\n        fig = fig_scatter_time(user_data=counts, title=title, xlabel=xlabel)\n    else:\n        fig = fig_scatter_time(\n            user_data=counts, username_to_color=self.user_color_mapping, title=title, xlabel=xlabel\n        )\n    return fig\n</code></pre>"},{"location":"reference/whatstk/graph/#whatstk.graph.FigureBuilder.user_message_responses_flow","title":"<code>user_message_responses_flow(title='Message flow')</code>","text":"<p>Get the flow of message responses.</p> <p>A response from user X to user Y happens if user X sends a message right after a message from user Y.</p> <p>Uses a Sankey diagram.</p> <p>Parameters:</p> Name Type Description Default <code>title</code> <code>str</code> <p>Title for plot. Defaults to \"Message flow\".</p> <code>'Message flow'</code> <p>Returns:</p> Type Description <code>Figure</code> <p>plotly.graph_objs.Figure: Plotly Figure.</p> <p>..  seealso::</p> <pre><code>* :func:`get_response_matrix &lt;whatstk.analysis.get_response_matrix&gt;`\n* :func:`fig_sankey &lt;whatstk.graph.figures.sankey.fig_sankey&gt;`\n</code></pre> Example <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n&gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_message_responses_flow()\n&gt;&gt;&gt; plot(fig)\n</code></pre> Source code in <code>whatstk/graph/base.py</code> <pre><code>def user_message_responses_flow(self, title: str = \"Message flow\") -&gt; go.Figure:\n    \"\"\"Get the flow of message responses.\n\n    A response from user X to user Y happens if user X sends a message right after a message from user Y.\n\n    Uses a Sankey diagram.\n\n    Args:\n        title (str, optional): Title for plot. Defaults to \"Message flow\".\n\n    Returns:\n        plotly.graph_objs.Figure: Plotly Figure.\n\n    ..  seealso::\n\n        * :func:`get_response_matrix &lt;whatstk.analysis.get_response_matrix&gt;`\n        * :func:`fig_sankey &lt;whatstk.graph.figures.sankey.fig_sankey&gt;`\n\n    Example:\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk import WhatsAppChat\n            &gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n            &gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_message_responses_flow()\n            &gt;&gt;&gt; plot(fig)\n\n    \"\"\"\n    # Get response matrix\n    responses = get_response_matrix(self.df)\n\n    # Node lists\n    label = self.usernames * 2\n    color = list(self.user_color_mapping.values()) * 2\n    # Link lists\n    n_users = len(self.usernames)\n    source = np.repeat(np.arange(n_users), n_users).tolist()\n    target = np.arange(n_users, 2 * n_users).tolist() * n_users\n    value = responses.values.flatten().tolist()\n\n    # Get figure\n    fig = fig_sankey(label=label, color=color, source=source, target=target, value=value, title=title)\n    return fig\n</code></pre>"},{"location":"reference/whatstk/graph/#whatstk.graph.FigureBuilder.user_message_responses_heatmap","title":"<code>user_message_responses_heatmap(norm=NORMS.ABSOLUTE, title='Response matrix')</code>","text":"<p>Get the response matrix heatmap.</p> <p>A response from user X to user Y happens if user X sends a message right after a message from user Y.</p> <p>Parameters:</p> Name Type Description Default <code>norm</code> <code>str</code> <p>Specifies the type of normalization used for reponse count. Can be:</p> <pre><code>            - ``'absolute'``: Absolute count of messages.\n            - ``'joint'``: Normalized by total number of messages sent by all users.\n            - ``'sender'``: Normalized per sender by total number of messages sent by user.\n            - ``'receiver'``: Normalized per receiver by total number of messages sent by user.\n</code></pre> <code>ABSOLUTE</code> <code>title</code> <code>str</code> <p>Title for plot. Defaults to \"Response matrix\".</p> <code>'Response matrix'</code> <p>Returns:</p> Type Description <code>Figure</code> <p>plotly.graph_objs.Figure: Plotly Figure.</p> <p>..  seealso::</p> <pre><code>* :func:`get_response_matrix &lt;whatstk.analysis.get_response_matrix&gt;`\n* :func:`fig_heatmap &lt;whatstk.graph.figures.heatmap.fig_heatmap&gt;`\n</code></pre> Example <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n&gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_message_responses_heatmap()\n&gt;&gt;&gt; plot(fig)\n</code></pre> Source code in <code>whatstk/graph/base.py</code> <pre><code>def user_message_responses_heatmap(self, norm: str = NORMS.ABSOLUTE, title: str = \"Response matrix\") -&gt; go.Figure:\n    \"\"\"Get the response matrix heatmap.\n\n    A response from user X to user Y happens if user X sends a message right after a message from user Y.\n\n    Args:\n        norm (str, optional): Specifies the type of normalization used for reponse count. Can be:\n\n                            - ``'absolute'``: Absolute count of messages.\n                            - ``'joint'``: Normalized by total number of messages sent by all users.\n                            - ``'sender'``: Normalized per sender by total number of messages sent by user.\n                            - ``'receiver'``: Normalized per receiver by total number of messages sent by user.\n        title (str, optional): Title for plot. Defaults to \"Response matrix\".\n\n    Returns:\n        plotly.graph_objs.Figure: Plotly Figure.\n\n    ..  seealso::\n\n        * :func:`get_response_matrix &lt;whatstk.analysis.get_response_matrix&gt;`\n        * :func:`fig_heatmap &lt;whatstk.graph.figures.heatmap.fig_heatmap&gt;`\n\n    Example:\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk import WhatsAppChat\n            &gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n            &gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_message_responses_heatmap()\n            &gt;&gt;&gt; plot(fig)\n\n    \"\"\"\n    # Get response matrix\n    responses = get_response_matrix(self.df, norm=norm)\n\n    # Get figure\n    fig = fig_heatmap(df_matrix=responses, title=title)\n    return fig\n</code></pre>"},{"location":"reference/whatstk/graph/#whatstk.graph.FigureBuilder.user_msg_length_boxplot","title":"<code>user_msg_length_boxplot(title='User message length', xlabel='User')</code>","text":"<p>Generate figure with boxplots of each user's message length.</p> <p>Parameters:</p> Name Type Description Default <code>title</code> <code>str</code> <p>Title for plot. Defaults to \"User message length\".</p> <code>'User message length'</code> <code>xlabel</code> <code>str</code> <p>x-axis label title. Defaults to \"User\".</p> <code>'User'</code> <p>Returns:</p> Name Type Description <code>dict</code> <code>Figure</code> <p>Dictionary with data and layout. Plotly compatible.</p> <p>..  seealso::</p> <pre><code>* :func:`fig_boxplot_msglen &lt;whatstk.graph.figures.boxplot.fig_boxplot_msglen&gt;`\n</code></pre> Example <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n&gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_msg_length_boxplot()\n&gt;&gt;&gt; plot(fig)\n</code></pre> Source code in <code>whatstk/graph/base.py</code> <pre><code>def user_msg_length_boxplot(self, title: str = \"User message length\", xlabel: str = \"User\") -&gt; go.Figure:\n    \"\"\"Generate figure with boxplots of each user's message length.\n\n    Args:\n        title (str, optional): Title for plot. Defaults to \"User message length\".\n        xlabel (str, optional): x-axis label title. Defaults to \"User\".\n\n    Returns:\n        dict: Dictionary with data and layout. Plotly compatible.\n\n    ..  seealso::\n\n        * :func:`fig_boxplot_msglen &lt;whatstk.graph.figures.boxplot.fig_boxplot_msglen&gt;`\n\n    Example:\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk import WhatsAppChat\n            &gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n            &gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_msg_length_boxplot()\n            &gt;&gt;&gt; plot(fig)\n\n    \"\"\"\n    fig = fig_boxplot_msglen(df=self.df, username_to_color=self.user_color_mapping, title=title, xlabel=xlabel)\n    return fig\n</code></pre>"},{"location":"reference/whatstk/graph/base/","title":"whatstk.graph.base","text":"<p>Build plotly-compatible figures.</p>"},{"location":"reference/whatstk/graph/base/#whatstk.graph.base.FigureBuilder","title":"<code>FigureBuilder(df=None, chat=None)</code>","text":"<p>Generate a variety of figures from your loaded chat.</p> <p>Integrates feature extraction and visualization logic to automate data plots.</p> <p>Note: Either <code>df</code> or <code>chat</code> must be provided.</p> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Chat data. Atribute <code>df</code> of a chat loaded using Chat. If a value is given,                                 <code>chat</code> is ignored.</p> <code>None</code> <code>chat</code> <code>Chat</code> <p>Chat data. Object obtained when chat loaded using Chat. Required if <code>df</code> is None.</p> <code>None</code> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Chat data. Atribute <code>df</code> of a chat loaded using Chat. If a value is given,                             <code>chat</code> is ignored.</p> <code>None</code> <code>chat</code> <code>Chat</code> <p>Chat data. Object obtained when chat loaded using Chat. Required if <code>df</code> is None.</p> <code>None</code> Source code in <code>whatstk/graph/base.py</code> <pre><code>def __init__(self, df: Optional[pd.DataFrame] = None, chat: \"BaseChat\" = None) -&gt; None:\n    \"\"\"Constructor.\n\n    Args:\n        df (pandas.DataFrame, optional): Chat data. Atribute `df` of a chat loaded using Chat. If a value is given,\n                                        ``chat`` is ignored.\n        chat (Chat, optional): Chat data. Object obtained when chat loaded using Chat. Required if ``df`` is None.\n\n    \"\"\"\n    self.df = _get_df(df=df, chat=chat)\n    # Check type of df\n    _check_types(self.df)\n    self.__user_color_mapping = None\n</code></pre>"},{"location":"reference/whatstk/graph/base/#whatstk.graph.base.FigureBuilder.user_color_mapping","title":"<code>user_color_mapping</code>  <code>property</code> <code>writable</code>","text":"<p>Get mapping between user and color.</p> <p>Each user is assigned a color automatically, so that this color is preserved for that user in all to-be-generated plots.</p> <p>Returns:</p> Name Type Description <code>dict</code> <code>Dict[str, str]</code> <p>Mapping from username to color (rgb).</p>"},{"location":"reference/whatstk/graph/base/#whatstk.graph.base.FigureBuilder.usernames","title":"<code>usernames</code>  <code>property</code>","text":"<p>Get list with users available in given chat.</p> <p>Returns:</p> Name Type Description <code>list</code> <code>BaseChat</code> <p>List with usernames available in chat DataFrame.</p>"},{"location":"reference/whatstk/graph/base/#whatstk.graph.base.FigureBuilder.user_interventions_count_linechart","title":"<code>user_interventions_count_linechart(date_mode='date', msg_length=False, cumulative=False, all_users=False, title='User interventions count', xlabel='Date/Time')</code>","text":"<p>Plot number of user interventions over time.</p> <p>Parameters:</p> Name Type Description Default <code>date_mode</code> <code>str</code> <p>Choose mode to group interventions by. Defaults to <code>'date'</code>. Available modes                         are:</p> <pre><code>                    - ``'date'``: Grouped by particular date (year, month and day).\n                    - ``'hour'``: Grouped by hours.\n                    - ``'month'``: Grouped by months.\n                    - ``'weekday'``: Grouped by weekday (i.e. monday, tuesday, ..., sunday).\n                    - ``'hourweekday'``: Grouped by weekday and hour.\n</code></pre> <code>'date'</code> <code>msg_length</code> <code>bool</code> <p>Set to True to count the number of characters instead of number of messages                          sent.</p> <code>False</code> <code>cumulative</code> <code>bool</code> <p>Set to True to obtain commulative counts.</p> <code>False</code> <code>all_users</code> <code>bool</code> <p>Obtain number of interventions of all users combined. Defaults to False.</p> <code>False</code> <code>title</code> <code>str</code> <p>Title for plot. Defaults to \"User interventions count\".</p> <code>'User interventions count'</code> <code>xlabel</code> <code>str</code> <p>x-axis label title. Defaults to \"Date/Time\".</p> <code>'Date/Time'</code> <p>Returns:</p> Type Description <code>Figure</code> <p>plotly.graph_objs.Figure: Plotly Figure.</p> <p>..  seealso::</p> <pre><code>* :func:`get_interventions_count &lt;whatstk.analysis.get_interventions_count&gt;`\n* :func:`fig_scatter_time &lt;whatstk.graph.figures.scatter.fig_scatter_time&gt;`\n</code></pre> Example <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n&gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_interventions_count_linechart(cumulative=True)\n&gt;&gt;&gt; plot(fig)\n</code></pre> Source code in <code>whatstk/graph/base.py</code> <pre><code>def user_interventions_count_linechart(\n    self,\n    date_mode: str = \"date\",\n    msg_length: bool = False,\n    cumulative: bool = False,\n    all_users: bool = False,\n    title: str = \"User interventions count\",\n    xlabel: str = \"Date/Time\",\n) -&gt; go.Figure:\n    \"\"\"Plot number of user interventions over time.\n\n    Args:\n        date_mode (str, optional): Choose mode to group interventions by. Defaults to ``'date'``. Available modes\n                                    are:\n\n                                    - ``'date'``: Grouped by particular date (year, month and day).\n                                    - ``'hour'``: Grouped by hours.\n                                    - ``'month'``: Grouped by months.\n                                    - ``'weekday'``: Grouped by weekday (i.e. monday, tuesday, ..., sunday).\n                                    - ``'hourweekday'``: Grouped by weekday and hour.\n        msg_length (bool, optional): Set to True to count the number of characters instead of number of messages\n                                     sent.\n        cumulative (bool, optional): Set to True to obtain commulative counts.\n        all_users (bool, optional): Obtain number of interventions of all users combined. Defaults to False.\n        title (str, optional): Title for plot. Defaults to \"User interventions count\".\n        xlabel (str, optional): x-axis label title. Defaults to \"Date/Time\".\n\n    Returns:\n        plotly.graph_objs.Figure: Plotly Figure.\n\n    ..  seealso::\n\n        * :func:`get_interventions_count &lt;whatstk.analysis.get_interventions_count&gt;`\n        * :func:`fig_scatter_time &lt;whatstk.graph.figures.scatter.fig_scatter_time&gt;`\n\n    Example:\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk import WhatsAppChat\n            &gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n            &gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_interventions_count_linechart(cumulative=True)\n            &gt;&gt;&gt; plot(fig)\n\n    \"\"\"\n    counts = get_interventions_count(\n        df=self.df,\n        date_mode=date_mode,\n        msg_length=msg_length,\n        cumulative=cumulative,\n        all_users=all_users,\n    )\n    if all_users:\n        fig = fig_scatter_time(user_data=counts, title=title, xlabel=xlabel)\n    else:\n        fig = fig_scatter_time(\n            user_data=counts, username_to_color=self.user_color_mapping, title=title, xlabel=xlabel\n        )\n    return fig\n</code></pre>"},{"location":"reference/whatstk/graph/base/#whatstk.graph.base.FigureBuilder.user_message_responses_flow","title":"<code>user_message_responses_flow(title='Message flow')</code>","text":"<p>Get the flow of message responses.</p> <p>A response from user X to user Y happens if user X sends a message right after a message from user Y.</p> <p>Uses a Sankey diagram.</p> <p>Parameters:</p> Name Type Description Default <code>title</code> <code>str</code> <p>Title for plot. Defaults to \"Message flow\".</p> <code>'Message flow'</code> <p>Returns:</p> Type Description <code>Figure</code> <p>plotly.graph_objs.Figure: Plotly Figure.</p> <p>..  seealso::</p> <pre><code>* :func:`get_response_matrix &lt;whatstk.analysis.get_response_matrix&gt;`\n* :func:`fig_sankey &lt;whatstk.graph.figures.sankey.fig_sankey&gt;`\n</code></pre> Example <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n&gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_message_responses_flow()\n&gt;&gt;&gt; plot(fig)\n</code></pre> Source code in <code>whatstk/graph/base.py</code> <pre><code>def user_message_responses_flow(self, title: str = \"Message flow\") -&gt; go.Figure:\n    \"\"\"Get the flow of message responses.\n\n    A response from user X to user Y happens if user X sends a message right after a message from user Y.\n\n    Uses a Sankey diagram.\n\n    Args:\n        title (str, optional): Title for plot. Defaults to \"Message flow\".\n\n    Returns:\n        plotly.graph_objs.Figure: Plotly Figure.\n\n    ..  seealso::\n\n        * :func:`get_response_matrix &lt;whatstk.analysis.get_response_matrix&gt;`\n        * :func:`fig_sankey &lt;whatstk.graph.figures.sankey.fig_sankey&gt;`\n\n    Example:\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk import WhatsAppChat\n            &gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n            &gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_message_responses_flow()\n            &gt;&gt;&gt; plot(fig)\n\n    \"\"\"\n    # Get response matrix\n    responses = get_response_matrix(self.df)\n\n    # Node lists\n    label = self.usernames * 2\n    color = list(self.user_color_mapping.values()) * 2\n    # Link lists\n    n_users = len(self.usernames)\n    source = np.repeat(np.arange(n_users), n_users).tolist()\n    target = np.arange(n_users, 2 * n_users).tolist() * n_users\n    value = responses.values.flatten().tolist()\n\n    # Get figure\n    fig = fig_sankey(label=label, color=color, source=source, target=target, value=value, title=title)\n    return fig\n</code></pre>"},{"location":"reference/whatstk/graph/base/#whatstk.graph.base.FigureBuilder.user_message_responses_heatmap","title":"<code>user_message_responses_heatmap(norm=NORMS.ABSOLUTE, title='Response matrix')</code>","text":"<p>Get the response matrix heatmap.</p> <p>A response from user X to user Y happens if user X sends a message right after a message from user Y.</p> <p>Parameters:</p> Name Type Description Default <code>norm</code> <code>str</code> <p>Specifies the type of normalization used for reponse count. Can be:</p> <pre><code>            - ``'absolute'``: Absolute count of messages.\n            - ``'joint'``: Normalized by total number of messages sent by all users.\n            - ``'sender'``: Normalized per sender by total number of messages sent by user.\n            - ``'receiver'``: Normalized per receiver by total number of messages sent by user.\n</code></pre> <code>ABSOLUTE</code> <code>title</code> <code>str</code> <p>Title for plot. Defaults to \"Response matrix\".</p> <code>'Response matrix'</code> <p>Returns:</p> Type Description <code>Figure</code> <p>plotly.graph_objs.Figure: Plotly Figure.</p> <p>..  seealso::</p> <pre><code>* :func:`get_response_matrix &lt;whatstk.analysis.get_response_matrix&gt;`\n* :func:`fig_heatmap &lt;whatstk.graph.figures.heatmap.fig_heatmap&gt;`\n</code></pre> Example <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n&gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_message_responses_heatmap()\n&gt;&gt;&gt; plot(fig)\n</code></pre> Source code in <code>whatstk/graph/base.py</code> <pre><code>def user_message_responses_heatmap(self, norm: str = NORMS.ABSOLUTE, title: str = \"Response matrix\") -&gt; go.Figure:\n    \"\"\"Get the response matrix heatmap.\n\n    A response from user X to user Y happens if user X sends a message right after a message from user Y.\n\n    Args:\n        norm (str, optional): Specifies the type of normalization used for reponse count. Can be:\n\n                            - ``'absolute'``: Absolute count of messages.\n                            - ``'joint'``: Normalized by total number of messages sent by all users.\n                            - ``'sender'``: Normalized per sender by total number of messages sent by user.\n                            - ``'receiver'``: Normalized per receiver by total number of messages sent by user.\n        title (str, optional): Title for plot. Defaults to \"Response matrix\".\n\n    Returns:\n        plotly.graph_objs.Figure: Plotly Figure.\n\n    ..  seealso::\n\n        * :func:`get_response_matrix &lt;whatstk.analysis.get_response_matrix&gt;`\n        * :func:`fig_heatmap &lt;whatstk.graph.figures.heatmap.fig_heatmap&gt;`\n\n    Example:\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk import WhatsAppChat\n            &gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n            &gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_message_responses_heatmap()\n            &gt;&gt;&gt; plot(fig)\n\n    \"\"\"\n    # Get response matrix\n    responses = get_response_matrix(self.df, norm=norm)\n\n    # Get figure\n    fig = fig_heatmap(df_matrix=responses, title=title)\n    return fig\n</code></pre>"},{"location":"reference/whatstk/graph/base/#whatstk.graph.base.FigureBuilder.user_msg_length_boxplot","title":"<code>user_msg_length_boxplot(title='User message length', xlabel='User')</code>","text":"<p>Generate figure with boxplots of each user's message length.</p> <p>Parameters:</p> Name Type Description Default <code>title</code> <code>str</code> <p>Title for plot. Defaults to \"User message length\".</p> <code>'User message length'</code> <code>xlabel</code> <code>str</code> <p>x-axis label title. Defaults to \"User\".</p> <code>'User'</code> <p>Returns:</p> Name Type Description <code>dict</code> <code>Figure</code> <p>Dictionary with data and layout. Plotly compatible.</p> <p>..  seealso::</p> <pre><code>* :func:`fig_boxplot_msglen &lt;whatstk.graph.figures.boxplot.fig_boxplot_msglen&gt;`\n</code></pre> Example <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import WhatsAppChat\n&gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n&gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_msg_length_boxplot()\n&gt;&gt;&gt; plot(fig)\n</code></pre> Source code in <code>whatstk/graph/base.py</code> <pre><code>def user_msg_length_boxplot(self, title: str = \"User message length\", xlabel: str = \"User\") -&gt; go.Figure:\n    \"\"\"Generate figure with boxplots of each user's message length.\n\n    Args:\n        title (str, optional): Title for plot. Defaults to \"User message length\".\n        xlabel (str, optional): x-axis label title. Defaults to \"User\".\n\n    Returns:\n        dict: Dictionary with data and layout. Plotly compatible.\n\n    ..  seealso::\n\n        * :func:`fig_boxplot_msglen &lt;whatstk.graph.figures.boxplot.fig_boxplot_msglen&gt;`\n\n    Example:\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk import WhatsAppChat\n            &gt;&gt;&gt; from whatstk.graph import plot, FigureBuilder\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.LOREM)\n            &gt;&gt;&gt; fig = FigureBuilder(chat=chat).user_msg_length_boxplot()\n            &gt;&gt;&gt; plot(fig)\n\n    \"\"\"\n    fig = fig_boxplot_msglen(df=self.df, username_to_color=self.user_color_mapping, title=title, xlabel=xlabel)\n    return fig\n</code></pre>"},{"location":"reference/whatstk/graph/figures/","title":"whatstk.graph.figures","text":"<p>Build Plotly compatible Figures.</p>"},{"location":"reference/whatstk/graph/figures/boxplot/","title":"whatstk.graph.figures.boxplot","text":"<p>Boxplot figures.</p>"},{"location":"reference/whatstk/graph/figures/boxplot/#whatstk.graph.figures.boxplot.fig_boxplot_msglen","title":"<code>fig_boxplot_msglen(df, username_to_color=None, title='', xlabel=None)</code>","text":"<p>Visualize boxplot.</p> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Chat data.</p> required <code>title</code> <code>str</code> <p>Title for plot. Defaults to \"\".</p> <code>''</code> <code>xlabel</code> <code>str</code> <p>x-axis label title. Defaults to None.</p> <code>None</code> <p>Returns:</p> Type Description <code>Figure</code> <p>plotly.graph_objs.Figure</p> Source code in <code>whatstk/graph/figures/boxplot.py</code> <pre><code>def fig_boxplot_msglen(\n    df: pd.DataFrame, username_to_color: Dict[str, str] = None, title: str = \"\", xlabel: Optional[str] = None\n) -&gt; go.Figure:\n    \"\"\"Visualize boxplot.\n\n    Args:\n        df (pandas.DataFrame): Chat data.\n        username_to_color (dict, optional). Dictionary mapping username to color. Defaults to None.\n        title (str, optional): Title for plot. Defaults to \"\".\n        xlabel (str, optional): x-axis label title. Defaults to None.\n\n    Returns:\n        plotly.graph_objs.Figure\n\n    \"\"\"\n    df = df.copy()\n    # Get message lengths\n    df[COLNAMES_DF.MESSAGE_LENGTH] = df[COLNAMES_DF.MESSAGE].apply(lambda x: len(x))\n    # Sort users by median\n    user_stats = (\n        df.groupby(COLNAMES_DF.USERNAME)\n        .aggregate({COLNAMES_DF.MESSAGE_LENGTH: \"median\"})[COLNAMES_DF.MESSAGE_LENGTH]\n        .sort_values(ascending=False)\n    )\n\n    # Create a list of traces\n    data = []\n\n    for username in user_stats.index:\n        x = df[df[COLNAMES_DF.USERNAME] == username][COLNAMES_DF.MESSAGE_LENGTH]\n        trace = go.Box(\n            y=x.values,\n            showlegend=True,\n            name=username,\n            boxpoints=\"outliers\",\n            marker_color=username_to_color[username] if username_to_color else None,\n        )\n        data.append(trace)\n\n    layout = dict(title=title, xaxis=dict(title=xlabel))\n\n    fig = go.Figure(data=data, layout=layout)\n\n    return fig\n</code></pre>"},{"location":"reference/whatstk/graph/figures/heatmap/","title":"whatstk.graph.figures.heatmap","text":"<p>Heatmap plot figures.</p>"},{"location":"reference/whatstk/graph/figures/heatmap/#whatstk.graph.figures.heatmap.fig_heatmap","title":"<code>fig_heatmap(df_matrix, title='')</code>","text":"<p>Generate heatmap figure from NxN matrix.</p> <p>Parameters:</p> Name Type Description Default <code>df_matrix</code> <code>DataFrame</code> <p>Matrix as DataFrame. Index values and column values must be equal.</p> required <code>title</code> <code>str</code> <p>Title of plot. Defaults to \"\".</p> <code>''</code> <p>Returns:</p> Type Description <code>Figure</code> <p>plotly.graph_objs.Figure</p> Source code in <code>whatstk/graph/figures/heatmap.py</code> <pre><code>def fig_heatmap(df_matrix: pd.DataFrame, title: str = \"\") -&gt; go.Figure:\n    \"\"\"Generate heatmap figure from NxN matrix.\n\n    Args:\n        df_matrix (pandas.DataFrame): Matrix as DataFrame. Index values and column values must be equal.\n        title (str): Title of plot. Defaults to \"\".\n\n    Returns:\n        plotly.graph_objs.Figure\n\n    \"\"\"\n    trace = go.Heatmap(\n        z=df_matrix,\n        x=df_matrix.columns,\n        y=df_matrix.index,\n        hovertemplate=\"%{y} ---&gt; %{x}&lt;extra&gt;%{z}&lt;/extra&gt;\",\n        colorscale=\"Greens\",\n    )\n    data = [trace]\n    layout = {\"title\": {\"text\": title}, \"xaxis\": {\"title\": \"Receiver\"}, \"yaxis\": {\"title\": \"Sender\"}}\n\n    fig = go.Figure(data=data, layout=layout)\n    return fig\n</code></pre>"},{"location":"reference/whatstk/graph/figures/sankey/","title":"whatstk.graph.figures.sankey","text":"<p>Sankey plot figures.</p>"},{"location":"reference/whatstk/graph/figures/sankey/#whatstk.graph.figures.sankey.fig_sankey","title":"<code>fig_sankey(label, color, source, target, value, title='')</code>","text":"<p>Generate sankey image.</p> <p>Parameters:</p> Name Type Description Default <code>label</code> <code>list</code> <p>List with node labels.</p> required <code>color</code> <code>list</code> <p>List with node colors.</p> required <code>source</code> <code>list</code> <p>List with link source id.</p> required <code>target</code> <code>list</code> <p>List with linke target id.</p> required <code>value</code> <code>list</code> <p>List with link value.</p> required <code>title</code> <code>str</code> <p>Title. Defaults to \"\".</p> <code>''</code> <p>Returns:</p> Type Description <code>Figure</code> <p>plotly.graph_objs.Figure</p> Source code in <code>whatstk/graph/figures/sankey.py</code> <pre><code>def fig_sankey(\n    label: List[str], color: List[str], source: List[str], target: List[str], value: List[int], title: str = \"\"\n) -&gt; go.Figure:\n    \"\"\"Generate sankey image.\n\n    Args:\n        label (list): List with node labels.\n        color (list): List with node colors.\n        source (list): List with link source id.\n        target (list): List with linke target id.\n        value (list): List with link value.\n        title (str, optional): Title. Defaults to \"\".\n\n    Returns:\n        plotly.graph_objs.Figure\n\n    \"\"\"\n    trace = go.Sankey(\n        arrangement=\"fixed\",\n        orientation=\"v\",\n        valueformat=\".0f\",\n        node=dict(\n            pad=20,\n            thickness=40,\n            line=dict(color=\"black\", width=0),\n            label=label,\n            color=color,\n            hovertemplate=\"%{label}&lt;br&gt;Number of messages: %{value}&lt;extra&gt;&lt;/extra&gt;\",\n            # x=x,\n            # y=y\n        ),\n        link=dict(\n            source=source,\n            target=target,\n            value=value,\n            hovertemplate=\"%{source.label} ---&gt; %{target.label}&lt;extra&gt;%{value}&lt;/extra&gt;\",\n        ),\n    )\n    data = [trace]\n\n    layout = {\n        \"title\": dict(text=title),\n        \"annotations\": [\n            {\n                \"text\": \"Senders\",\n                \"font\": {\n                    \"size\": 13,\n                    \"color\": \"rgb(116, 101, 130)\",\n                },\n                \"showarrow\": False,\n                \"align\": \"center\",\n                \"x\": 0.5,\n                \"y\": 1.1,\n                \"xref\": \"paper\",\n                \"yref\": \"paper\",\n            },\n            {\n                \"text\": \"Receivers\",\n                \"font\": {\n                    \"size\": 13,\n                    \"color\": \"rgb(116, 101, 130)\",\n                },\n                \"showarrow\": False,\n                \"align\": \"center\",\n                \"x\": 0.5,\n                \"y\": -0.1,\n                \"xref\": \"paper\",\n                \"yref\": \"paper\",\n            },\n        ],\n    }\n\n    fig = go.Figure(data=data, layout=layout)\n\n    return fig\n</code></pre>"},{"location":"reference/whatstk/graph/figures/scatter/","title":"whatstk.graph.figures.scatter","text":"<p>Scatter plot figures.</p>"},{"location":"reference/whatstk/graph/figures/scatter/#whatstk.graph.figures.scatter.fig_scatter_time","title":"<code>fig_scatter_time(user_data, username_to_color=None, title='', xlabel=None)</code>","text":"<p>Obtain Figure to plot using plotly.</p> <p><code>user_data</code> must be a pandas.DataFrame with timestamps as index and a column for each user. You can easily generate suitable <code>user_data</code> using the function :func:<code>get_interventions_count &lt;whatstk.analysis.get_interventions_count&gt;</code> (disclaimer: not compatible with <code>date_mode='hourweekday'</code>).</p> <p>Parameters:</p> Name Type Description Default <code>user_data</code> <code>DataFrame</code> <p>Input data. Shape nrows x ncols, where nrows = number of timestaps and                           ncols = number of users.</p> required <code>title</code> <code>str</code> <p>Title of figure. Defaults to \"\".</p> <code>''</code> <code>xlabel</code> <code>str</code> <p>x-axis label title. Defaults to None.</p> <code>None</code> <p>Returns:</p> Type Description <code>Figure</code> <p>plotly.graph_objs.Figure</p> <p>..  seealso::</p> <pre><code>    * :func:`get_interventions_count &lt;whatstk.analysis.get_interventions_count&gt;`\n</code></pre> Source code in <code>whatstk/graph/figures/scatter.py</code> <pre><code>def fig_scatter_time(\n    user_data: pd.DataFrame,\n    username_to_color: Optional[Dict[str, str]] = None,\n    title: str = \"\",\n    xlabel: Optional[str] = None,\n) -&gt; go.Figure:\n    \"\"\"Obtain Figure to plot using plotly.\n\n    ``user_data`` must be a pandas.DataFrame with timestamps as index and a column for each user. You can easily\n    generate suitable ``user_data`` using the function\n    :func:`get_interventions_count &lt;whatstk.analysis.get_interventions_count&gt;` (disclaimer: not compatible with\n    ``date_mode='hourweekday'``).\n\n    Args:\n        user_data (pandas.DataFrame): Input data. Shape nrows x ncols, where nrows = number of timestaps and\n                                      ncols = number of users.\n        username_to_color (dict, optional). Dictionary mapping username to color. Defaults to None.\n        title (str, optional): Title of figure. Defaults to \"\".\n        xlabel (str, optional): x-axis label title. Defaults to None.\n\n    Returns:\n        plotly.graph_objs.Figure\n\n    ..  seealso::\n\n            * :func:`get_interventions_count &lt;whatstk.analysis.get_interventions_count&gt;`\n\n    \"\"\"\n    # Create a trace\n    data = []\n\n    for username in user_data:\n        trace = go.Scatter(\n            x=user_data.index,\n            y=user_data[username],\n            showlegend=True,\n            name=username,\n            text=user_data.index,\n            line=dict(color=username_to_color[username]) if username_to_color is not None else None,\n        )\n        data.append(trace)\n\n    layout = dict(title=title, xaxis=dict(title=xlabel))\n\n    fig = go.Figure(data=data, layout=layout)\n\n    return fig\n</code></pre>"},{"location":"reference/whatstk/graph/figures/utils/","title":"whatstk.graph.figures.utils","text":"<p>Utils for library plots.</p>"},{"location":"reference/whatstk/graph/figures/utils/#whatstk.graph.figures.utils.hex_color_palette","title":"<code>hex_color_palette(n_colors)</code>","text":"<p>Get palette of <code>n_colors</code> color hexadecimal codes.</p> <p>Parameters:</p> Name Type Description Default <code>n_colors</code> <code>int</code> <p>Size of the color palette.</p> required Source code in <code>whatstk/graph/figures/utils.py</code> <pre><code>def hex_color_palette(n_colors: int) -&gt; List[str]:\n    \"\"\"Get palette of `n_colors` color hexadecimal codes.\n\n    Args:\n        n_colors (int): Size of the color palette.\n\n    \"\"\"\n    palette = \"hls\"  # ref: https://seaborn.pydata.org/tutorial/color_palettes.html\n    rgb = sns.color_palette(palette=palette, n_colors=n_colors)\n    color_codes = [\"#\" + \"\".join(\"%02X\" % int(round(i * 255)) for i in r) for r in rgb]\n    return color_codes\n</code></pre>"},{"location":"reference/whatstk/scripts/","title":"whatstk.scripts","text":"<p>Library generic scripts.</p>"},{"location":"reference/whatstk/scripts/generate_chats/","title":"whatstk.scripts.generate_chats","text":"<p>Generate chats in all hformats with <code>size</code> number of messages and export them to a given <code>output_path</code>.</p>"},{"location":"reference/whatstk/scripts/generate_chats/#whatstk.scripts.generate_chats.main","title":"<code>main()</code>","text":"<p>Main script.</p> Source code in <code>whatstk/scripts/generate_chats.py</code> <pre><code>def main() -&gt; None:\n    \"\"\"Main script.\"\"\"\n    args = _parse_args()\n    generate_chats_hformats(\n        output_path=args.output_path,\n        size=args.size,\n        hformats=args.hformats,\n        last_timestamp=args.last_timestamp,\n        filepaths=args.filenames,\n        export_as_zip=args.export_as_zip\n    )\n</code></pre>"},{"location":"reference/whatstk/scripts/graph/","title":"whatstk.scripts.graph","text":"<p>Generate multiple graphics for your chat using plotly.</p>"},{"location":"reference/whatstk/scripts/graph/#whatstk.scripts.graph.main","title":"<code>main()</code>","text":"<p>Main script.</p> Source code in <code>whatstk/scripts/graph.py</code> <pre><code>def main() -&gt; None:\n    \"\"\"Main script.\"\"\"\n    args = _parse_args()\n    chat = WhatsAppChat.from_source(filepath=args.input_filename, hformat=args.hformat)\n\n    if args.type == \"interventions_count\":\n        fig = FigureBuilder(chat=chat).user_interventions_count_linechart(\n            date_mode=args.icount_date_mode, msg_length=False, cumulative=args.icount_cumulative\n        )\n    elif args.type == \"msg_length\":\n        fig = FigureBuilder(chat=chat).user_msg_length_boxplot()\n    plot(fig, filename=args.output_filename)\n</code></pre>"},{"location":"reference/whatstk/scripts/txt_to_csv/","title":"whatstk.scripts.txt_to_csv","text":"<p>Generate chats in all hformats with <code>size</code> number of messages and export them to a given <code>output_path</code>.</p>"},{"location":"reference/whatstk/scripts/txt_to_csv/#whatstk.scripts.txt_to_csv.main","title":"<code>main()</code>","text":"<p>Main script.</p> Source code in <code>whatstk/scripts/txt_to_csv.py</code> <pre><code>def main() -&gt; None:\n    \"\"\"Main script.\"\"\"\n    args = _parse_args()\n    chat = WhatsAppChat.from_source(filepath=args.input_filename, hformat=args.hformat)\n    chat.to_csv(args.output_filename)\n</code></pre>"},{"location":"reference/whatstk/utils/","title":"whatstk.utils","text":"<p>Library generic utils.</p>"},{"location":"reference/whatstk/utils/chat_merge/","title":"whatstk.utils.chat_merge","text":"<p>Merging chats.</p>"},{"location":"reference/whatstk/utils/chat_merge/#whatstk.utils.chat_merge.merge_chats","title":"<code>merge_chats(dfs)</code>","text":"<p>Merge several chats into a single one.</p> <p>Can come in handy when you have old exports and new ones, and both have relevant data.</p> <p>Note: The dataframes must have an index with the timestamps of the messages, as this is required to correctly sort and merge the chats.</p> <p>Parameters:</p> Name Type Description Default <code>dfs</code> <code>List[DataFrame]</code> <p>List with the chats as DataFrames.</p> required <p>Returns:</p> Type Description <code>DataFrame</code> <p>pandas.DataFrame: Merged chat.</p> Source code in <code>whatstk/utils/chat_merge.py</code> <pre><code>def merge_chats(dfs: List[pd.DataFrame]) -&gt; pd.DataFrame:\n    \"\"\"Merge several chats into a single one.\n\n    Can come in handy when you have old exports and new ones, and both have relevant data.\n\n    **Note:** The dataframes must have an index with the timestamps of the messages, as this is required to correctly\n    sort and merge the chats.\n\n    Args:\n        dfs (List[pandas.DataFrame]): List with the chats as DataFrames.\n\n    Returns:\n        pandas.DataFrame: Merged chat.\n\n    \"\"\"\n    # Sort from oldest\n    dfs = sorted(dfs, key=lambda x: x.index.min())\n    # Merge\n    df = dfs[0]\n    for i in range(1, len(dfs)):\n        df = _merge_two_chats(df, dfs[i])\n    return df\n</code></pre>"},{"location":"reference/whatstk/utils/exceptions/","title":"whatstk.utils.exceptions","text":"<p>Library exceptions.</p>"},{"location":"reference/whatstk/utils/exceptions/#whatstk.utils.exceptions.HFormatError","title":"<code>HFormatError</code>","text":"<p>               Bases: <code>Exception</code></p> <p>Raised when hformat could not be found.</p>"},{"location":"reference/whatstk/utils/exceptions/#whatstk.utils.exceptions.RegexError","title":"<code>RegexError</code>","text":"<p>               Bases: <code>Exception</code></p> <p>Raised when regex match is not possible.</p>"},{"location":"reference/whatstk/utils/gdrive/","title":"whatstk.utils.gdrive","text":"<p>Google Drive utils.</p> <p>.. warning::</p> <pre><code>To load chats from google drive, install the library with the corresponding extension (ignore the\n``--upgrade`` option if you haven't installed the library):\n\n.. code-block::\n\n    pip install whatstk[gdrive] --upgrade\n</code></pre>"},{"location":"reference/whatstk/utils/gdrive/#whatstk.utils.gdrive.gdrive_init","title":"<code>gdrive_init(client_secret_file, encoding='utf8')</code>","text":"<p>Initialize GDrive credentials.</p> <p>This should only run once before reading a file from Google Drive the first time. Subsequent executions should run seamlessly.</p> <p>To obtain <code>client_secret_file</code>, follow the instructions from: https://medium.com/analytics-vidhya/how-to-connect-google-drive-to-python-using-pydrive-9681b2a14f20</p> Notes <ul> <li>Additionally, make sure to add yourself in Test users, as noted in:   https://stackoverflow.com/questions/65980758/pydrive-quickstart-and-error-403-access-denied</li> <li>Select Desktop App instead of Web Application as the application type.</li> </ul> <p>Parameters:</p> Name Type Description Default <code>client_secret_file</code> <code>str</code> <p>Path to clien_secret.json file (Created in Google Console).</p> required <code>encoding</code> <code>str</code> <p>Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).                  <code>List of Python standard encodings                  &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;</code>_.</p> <code>'utf8'</code> Source code in <code>whatstk/utils/gdrive.py</code> <pre><code>def gdrive_init(client_secret_file: str, encoding: str = \"utf8\") -&gt; None:\n    \"\"\"Initialize GDrive credentials.\n\n    This should only run once before reading a file from Google Drive the first time. Subsequent executions should run\n    seamlessly.\n\n    To obtain `client_secret_file`, follow the instructions from:\n    https://medium.com/analytics-vidhya/how-to-connect-google-drive-to-python-using-pydrive-9681b2a14f20\n\n    Notes:\n        - Additionally, make sure to add yourself in Test users, as noted in:\n          https://stackoverflow.com/questions/65980758/pydrive-quickstart-and-error-403-access-denied\n        - Select Desktop App instead of Web Application as the application type.\n\n    Args:\n        client_secret_file (str): Path to clien_secret.json file (Created in Google Console).\n        encoding (str): Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).\n                             `List of Python standard encodings\n                             &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;`_.\n    \"\"\"\n    if not os.path.isdir(CONFIG_PATH):\n        os.makedirs(CONFIG_PATH, exist_ok=True)\n\n    # Copy credentials to config folder\n    copyfile(client_secret_file, CLIENT_SECRETS_PATH)\n\n    # Create settings.yaml file\n    dix = {\n        \"client_config_backend\": \"file\",\n        \"client_config_file\": CLIENT_SECRETS_PATH,\n        \"save_credentials\": True,\n        \"save_credentials_backend\": \"file\",\n        \"save_credentials_file\": CREDENTIALS_PATH,\n        \"get_refresh_token\": True,\n        \"oauth_scope\": [\n            \"https://www.googleapis.com/auth/drive\",\n            \"https://www.googleapis.com/auth/drive.install\",\n        ],\n    }\n    with open(SETTINGS_PATH, \"w\", encoding=encoding) as f:\n        yaml.dump(dix, f)\n\n    # credentials.json\n    gauth = GoogleAuth(settings_file=SETTINGS_PATH)\n    gauth.CommandLineAuth()\n</code></pre>"},{"location":"reference/whatstk/utils/utils/","title":"whatstk.utils.utils","text":"<p>Utils.</p>"},{"location":"reference/whatstk/utils/utils/#whatstk.utils.utils.ColnamesDf","title":"<code>ColnamesDf</code>","text":"<p>Access class constants using variable <code>whatstk.utils.utils.COLNAMES_DF</code>.</p> Example <p>Access constant <code>COLNAMES_DF.DATE</code>:</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk.utils.utils import COLNAMES_DF\n&gt;&gt;&gt; COLNAMES_DF.DATE\n'date'\n</code></pre>"},{"location":"reference/whatstk/utils/utils/#whatstk.utils.utils.ColnamesDf.DATE","title":"<code>DATE = 'date'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Date column</p>"},{"location":"reference/whatstk/utils/utils/#whatstk.utils.utils.ColnamesDf.MESSAGE","title":"<code>MESSAGE = 'message'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Message column</p>"},{"location":"reference/whatstk/utils/utils/#whatstk.utils.utils.ColnamesDf.MESSAGE_LENGTH","title":"<code>MESSAGE_LENGTH = 'message_length'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Message length column</p>"},{"location":"reference/whatstk/utils/utils/#whatstk.utils.utils.ColnamesDf.MESSAGE_TYPE","title":"<code>MESSAGE_TYPE = 'message_type'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Message type column</p>"},{"location":"reference/whatstk/utils/utils/#whatstk.utils.utils.ColnamesDf.USERNAME","title":"<code>USERNAME = 'username'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":"<p>Username column</p>"},{"location":"reference/whatstk/whatsapp/","title":"whatstk.whatsapp","text":"<p>WhatsApp parser.</p>"},{"location":"reference/whatstk/whatsapp/auto_header/","title":"whatstk.whatsapp.auto_header","text":"<p>Detect header from chat.</p>"},{"location":"reference/whatstk/whatsapp/auto_header/#whatstk.whatsapp.auto_header.extract_header_from_text","title":"<code>extract_header_from_text(text, encoding='utf-8')</code>","text":"<p>Extract header from text.</p> <p>Parameters:</p> Name Type Description Default <code>text</code> <code>str</code> <p>Loaded chat as string (whole text).</p> required <code>encoding</code> <code>str</code> <p>Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).                  <code>List of Python standard encodings                  &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;</code>_.</p> <code>'utf-8'</code> <p>Returns:</p> Name Type Description <code>str</code> <code>Optional[str]</code> <p>Format extracted. None if no header was extracted.</p> Example <p>Load a chat using two text files. In this example, we use sample chats (available online, see urls in source code :mod:<code>whatstk.data &lt;whatstk.data&gt;</code>).</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk.whatsapp.parser import extract_header_from_text\n&gt;&gt;&gt; from urllib.request import urlopen\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; filepath_1 = whatsapp_urls.POKEMON\n&gt;&gt;&gt; with urlopen(filepath_1) as f:\n...     text = f.read().decode('utf-8')\n&gt;&gt;&gt; extract_header_from_text(text)\n'%d.%m.%y, %H:%M - %name:\n</code></pre> Source code in <code>whatstk/whatsapp/auto_header.py</code> <pre><code>def extract_header_from_text(text: str, encoding: str = \"utf-8\") -&gt; Optional[str]:\n    \"\"\"Extract header from text.\n\n    Args:\n        text (str): Loaded chat as string (whole text).\n        encoding (str): Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).\n                             `List of Python standard encodings\n                             &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;`_.\n\n    Returns:\n        str: Format extracted. None if no header was extracted.\n\n    Example:\n            Load a chat using two text files. In this example, we use sample chats (available online, see urls in\n            source code :mod:`whatstk.data &lt;whatstk.data&gt;`).\n\n            ..  code-block:: python\n\n                &gt;&gt;&gt; from whatstk.whatsapp.parser import extract_header_from_text\n                &gt;&gt;&gt; from urllib.request import urlopen\n                &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n                &gt;&gt;&gt; filepath_1 = whatsapp_urls.POKEMON\n                &gt;&gt;&gt; with urlopen(filepath_1) as f:\n                ...     text = f.read().decode('utf-8')\n                &gt;&gt;&gt; extract_header_from_text(text)\n                '%d.%m.%y, %H:%M - %name:\n    \"\"\"\n    # Split lines\n    lines = text.split(\"\\n\")\n\n    # Get format auto\n    try:\n        hformat = _extract_header_format_from_lines(lines)\n        logging.info(\"Format found was %s\", hformat)\n        return hformat\n    except Exception as err:  # noqa\n        logging.info(\"Format not found.\")\n    return None\n</code></pre>"},{"location":"reference/whatstk/whatsapp/generation/","title":"whatstk.whatsapp.generation","text":"<p>Automatic generation of chat using Lorem Ipsum text and time series statistics.</p>"},{"location":"reference/whatstk/whatsapp/generation/#whatstk.whatsapp.generation.ChatGenerator","title":"<code>ChatGenerator(size, users=None, seed=100)</code>","text":"<p>Generate a chat.</p> <p>Parameters:</p> Name Type Description Default <code>size</code> <code>int</code> <p>Number of messages to generate.</p> required <code>users</code> <code>list</code> <p>List with names of the users. Defaults to module variable USERS.</p> <code>None</code> <code>seed</code> <code>int</code> <p>Seed for random processes. Defaults to 100.</p> <code>100</code> <p>Examples:</p> <p>This simple example loads a chat using :func:<code>WhatsAppChat &lt;whatstk.whatsapp.objects.WhatsAppChat&gt;</code>. Once loaded, we can access its attribute <code>df</code>, which contains the loaded chat as a DataFrame.</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk.whatsapp.generation import ChatGenerator\n&gt;&gt;&gt; from datetime import datetime\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = ChatGenerator(size=10).generate(last_timestamp=datetime(2020, 1, 1, 0, 0))\n&gt;&gt;&gt; chat.df.head(5)\n                        date  username                                            message\n0 2019-12-31 09:43:04.000525  Giuseppe                               Nisi ad esse cillum.\n1 2019-12-31 10:19:21.980039  Giuseppe      Tempor dolore sint in eu lorem veniam veniam.\n2 2019-12-31 13:56:45.575426  Giuseppe  Do quis fugiat sint ut ut, do anim eu est qui ...\n3 2019-12-31 15:47:29.995420  Giuseppe  Do qui qui elit ea in sed culpa, aliqua magna ...\n4 2019-12-31 16:23:00.348542      Mary  Sunt excepteur mollit voluptate dolor sint occ...\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>size</code> <code>int</code> <p>Number of messages to generate.</p> required <code>users</code> <code>list</code> <p>List with names of the users. Defaults to module variable USERS.</p> <code>None</code> <code>seed</code> <code>int</code> <p>Seed for random processes. Defaults to 100.</p> <code>100</code> Source code in <code>whatstk/whatsapp/generation.py</code> <pre><code>def __init__(self, size: int, users: Optional[List[str]] = None, seed: int = 100) -&gt; None:\n    \"\"\"Instantiate ChatGenerator class.\n\n    Args:\n        size (int): Number of messages to generate.\n        users (list, optional): List with names of the users. Defaults to module variable USERS.\n        seed (int, optional): Seed for random processes. Defaults to 100.\n\n    \"\"\"\n    self.size = size\n    self.users = USERS if not users else users\n    self.seed = seed\n    np.random.seed(seed=self.seed)\n</code></pre>"},{"location":"reference/whatstk/whatsapp/generation/#whatstk.whatsapp.generation.ChatGenerator.generate","title":"<code>generate(filepath=None, hformat=None, last_timestamp=None)</code>","text":"<p>Generate random chat as :func:<code>WhatsAppChat &lt;whatstk.whatsapp.objects.WhatsAppChat&gt;</code>.</p> <p>Parameters:</p> Name Type Description Default <code>filepath</code> <code>str</code> <p>If given, generated chat is saved with name <code>filepath</code> (must be a local path).</p> <code>None</code> <code>hformat</code> <code>str</code> <p>:ref:<code>Format of the header &lt;The header format&gt;</code>, e.g.                     <code>'[%y-%m-%d %H:%M:%S] - %name:'</code>.</p> <code>None</code> <code>last_timestamp</code> <code>datetime</code> <p>Datetime of last message. If <code>None</code>, defaults to current date.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>WhatsAppChat</code> <code>str</code> <p>Chat with random messages.</p> <p>..  seealso::</p> <pre><code>* :func:`WhatsAppChat.to_txt &lt;whatstk.whatsapp.objects.WhatsAppChat.to_txt&gt;`\n</code></pre> Source code in <code>whatstk/whatsapp/generation.py</code> <pre><code>def generate(\n    self, filepath: Optional[str] = None, hformat: Optional[str] = None, last_timestamp: Optional[datetime] = None\n) -&gt; str:\n    \"\"\"Generate random chat as :func:`WhatsAppChat &lt;whatstk.whatsapp.objects.WhatsAppChat&gt;`.\n\n    Args:\n        filepath (str): If given, generated chat is saved with name ``filepath`` (must be a local path).\n        hformat (str, optional): :ref:`Format of the header &lt;The header format&gt;`, e.g.\n                                ``'[%y-%m-%d %H:%M:%S] - %name:'``.\n        last_timestamp (datetime, optional): Datetime of last message. If `None`, defaults to current date.\n\n    Returns:\n        WhatsAppChat: Chat with random messages.\n\n    ..  seealso::\n\n        * :func:`WhatsAppChat.to_txt &lt;whatstk.whatsapp.objects.WhatsAppChat.to_txt&gt;`\n\n    \"\"\"\n    df = self._generate_df(last_timestamp=last_timestamp)\n    chat = WhatsAppChat(df)\n    if filepath:\n        chat.to_txt(filepath=filepath, hformat=hformat)\n    return chat\n</code></pre>"},{"location":"reference/whatstk/whatsapp/generation/#whatstk.whatsapp.generation.generate_chats_hformats","title":"<code>generate_chats_hformats(output_path, size=2000, hformats=None, filepaths=None, last_timestamp=None, seed=100, verbose=False, export_as_zip=False)</code>","text":"<p>Generate a chat and export using given header format.</p> <p>If no hformat specified, chat is generated &amp; exported using all supported header formats.</p> <p>Parameters:</p> Name Type Description Default <code>output_path</code> <code>str</code> <p>Path to directory to export all generated chats as txt.</p> required <code>size</code> <code>int</code> <p>Number of messages of the chat. Defaults to 2000.</p> <code>2000</code> <code>hformats</code> <code>list</code> <p>List of header formats to use when exporting chat. If None,                         defaults to all supported header formats.</p> <code>None</code> <code>filepaths</code> <code>list</code> <p>List with filepaths (only txt files). If None, defaults to                         <code>whatstk.utils.utils._map_hformat_filename(filepath)</code>.</p> <code>None</code> <code>last_timestamp</code> <code>datetime</code> <p>Datetime of last message. If <code>None</code>, defaults to current date.</p> <code>None</code> <code>seed</code> <code>int</code> <p>Seed for random processes. Defaults to 100.</p> <code>100</code> <code>verbose</code> <code>bool</code> <p>Set to True to print runtime messages.</p> <code>False</code> <code>export_as_zip</code> <code>bool</code> <p>Set to True to export the chat(s) zipped, additionally.</p> <code>False</code> <p>..  seealso::</p> <pre><code>    * :func:`ChatGenerator &lt;ChatGenerator&gt;`\n    * :func:`ChatGenerator.generate &lt;ChatGenerator.generate&gt;`\n</code></pre> Source code in <code>whatstk/whatsapp/generation.py</code> <pre><code>def generate_chats_hformats(\n    output_path: str,\n    size: int = 2000,\n    hformats: Optional[str] = None,\n    filepaths: Optional[str] = None,\n    last_timestamp: Optional[datetime] = None,\n    seed: int = 100,\n    verbose: bool = False,\n    export_as_zip: bool = False,\n) -&gt; None:\n    r\"\"\"Generate a chat and export using given header format.\n\n    If no hformat specified, chat is generated &amp; exported using all supported header formats.\n\n    Args:\n        output_path (str): Path to directory to export all generated chats as txt.\n        size (int, optional): Number of messages of the chat. Defaults to 2000.\n        hformats (list, optional): List of header formats to use when exporting chat. If None,\n                                    defaults to all supported header formats.\n        filepaths (list, optional): List with filepaths (only txt files). If None, defaults to\n                                    `whatstk.utils.utils._map_hformat_filename(filepath)`.\n        last_timestamp (datetime, optional): Datetime of last message. If `None`, defaults to current date.\n        seed (int, optional): Seed for random processes. Defaults to 100.\n        verbose (bool): Set to True to print runtime messages.\n        export_as_zip (bool): Set to True to export the chat(s) zipped, additionally.\n\n    ..  seealso::\n\n            * :func:`ChatGenerator &lt;ChatGenerator&gt;`\n            * :func:`ChatGenerator.generate &lt;ChatGenerator.generate&gt;`\n\n    \"\"\"\n    if not hformats:\n        hformats = get_supported_hformats_as_list()\n\n    # Sanity check\n    if filepaths:\n        if len(filepaths) != len(hformats):\n            raise ValueError(\"Length of filepaths must be equal to length of hformats.\")\n\n    # Generate chat\n    chat = ChatGenerator(size=size, seed=seed).generate(last_timestamp=last_timestamp)\n    for i in range(len(hformats)):\n        hformat = hformats[i]\n        print(\"Exporting format: {}\".format(hformat)) if verbose else 0\n        if filepaths:\n            filepath = filepaths[i]\n        else:\n            filepath = _map_hformat_filename(hformat)\n            filepath = \"{}.txt\".format(filepath)\n        filepath = os.path.join(output_path, filepath)\n        chat.to_txt(filepath=filepath, hformat=hformat)\n        if export_as_zip:\n            chat.to_zip(filepath.replace(\".txt\", \".zip\"), hformat)\n</code></pre>"},{"location":"reference/whatstk/whatsapp/hformat/","title":"whatstk.whatsapp.hformat","text":"<p>Header format utils.</p> <p>Example: Check if header is available.</p> <pre><code>..  code-block:: python\n\n    &gt;&gt;&gt; from whatstk.utils.hformat import is_supported\n    &gt;&gt;&gt; is_supported('%y-%m-%d, %H:%M:%S - %name:')\n    (True, True)\n</code></pre>"},{"location":"reference/whatstk/whatsapp/hformat/#whatstk.whatsapp.hformat.get_supported_hformats_as_dict","title":"<code>get_supported_hformats_as_dict(encoding='utf8')</code>","text":"<p>Get dictionary with supported formats and relevant info.</p> <p>Parameters:</p> Name Type Description Default <code>encoding</code> <code>str</code> <p>Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).                  <code>List of Python standard encodings                  &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;</code>_.</p> <code>'utf8'</code> <p>Returns:</p> Name Type Description <code>dict</code> <code>Dict[str, int]</code> <p>Dict with two elements:     * <code>format</code>: Header format. All formats appearing are supported.     * <code>auto_header</code>: 1 if auto_header is supported), 0 otherwise.</p> Source code in <code>whatstk/whatsapp/hformat.py</code> <pre><code>def get_supported_hformats_as_dict(encoding: str = \"utf8\") -&gt; Dict[str, int]:\n    \"\"\"Get dictionary with supported formats and relevant info.\n\n    Args:\n        encoding (str, optional): Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).\n                             `List of Python standard encodings\n                             &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;`_.\n\n    Returns:\n        dict: Dict with two elements:\n                * ``format``: Header format. All formats appearing are supported.\n                * ``auto_header``: 1 if auto_header is supported), 0 otherwise.\n\n    \"\"\"\n    with open(hformat_support_filepath, \"r\", encoding=encoding) as f:\n        headers = json.load(f)\n    return headers\n</code></pre>"},{"location":"reference/whatstk/whatsapp/hformat/#whatstk.whatsapp.hformat.get_supported_hformats_as_list","title":"<code>get_supported_hformats_as_list(encoding='utf8')</code>","text":"<p>Get list of supported formats.</p> <p>Returns:</p> Name Type Description <code>list</code> <code>List[str]</code> <p>List with supported formats (as str).</p> <code>encoding</code> <code>(str, optional)</code> <p>Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019). <code>List of Python standard encodings &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;</code>_.</p> Source code in <code>whatstk/whatsapp/hformat.py</code> <pre><code>def get_supported_hformats_as_list(encoding: str = \"utf8\") -&gt; List[str]:\n    \"\"\"Get list of supported formats.\n\n    Returns:\n        list: List with supported formats (as str).\n        encoding (str, optional): Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).\n            `List of Python standard encodings &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;`_.\n    \"\"\"\n    with open(hformat_support_filepath, \"r\", encoding=encoding) as f:\n        h = json.load(f)\n    return [hh[\"format\"] for hh in h]\n</code></pre>"},{"location":"reference/whatstk/whatsapp/hformat/#whatstk.whatsapp.hformat.is_supported","title":"<code>is_supported(hformat, encoding='utf8')</code>","text":"<p>Check if header <code>hformat</code> is currently supported.</p> <p>Parameters:</p> Name Type Description Default <code>hformat</code> <code>str</code> <p>Header format.</p> required <code>encoding</code> <code>str</code> <p>Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).                  <code>List of Python standard encodings                  &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;</code>_.</p> <code>'utf8'</code> <p>Returns:</p> Name Type Description <code>tuple</code> <code>Tuple[bool, bool]</code> <pre><code>* bool: True if header is supported.\n* bool: True if header is supported with `auto_header` feature.\n</code></pre> Source code in <code>whatstk/whatsapp/hformat.py</code> <pre><code>def is_supported(hformat: str, encoding: str = \"utf8\") -&gt; Tuple[bool, bool]:\n    \"\"\"Check if header `hformat` is currently supported.\n\n    Args:\n        hformat (str): Header format.\n        encoding (str, optional): Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).\n                             `List of Python standard encodings\n                             &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;`_.\n\n    Returns:\n        tuple:\n                * bool: True if header is supported.\n                * bool: True if header is supported with `auto_header` feature.\n\n    \"\"\"\n    with open(hformat_support_filepath, \"r\", encoding=encoding) as f:\n        h = json.load(f)\n\n    if \"%P\" in hformat or \"%p\" in hformat:\n        hformat = hformat.replace(\"%P\", \"%p\").replace(\"%H\", \"%I\")\n    hformat = hformat.replace(\"%Y\", \"%y\")\n    auto_header_support = 0\n    support = 0\n    for hh in h:\n        if hformat == hh[\"format\"]:\n            support = 1\n            auto_header_support = hh[\"auto_header\"]\n\n    return bool(support), bool(auto_header_support)\n</code></pre>"},{"location":"reference/whatstk/whatsapp/hformat/#whatstk.whatsapp.hformat.is_supported_verbose","title":"<code>is_supported_verbose(hformat)</code>","text":"<p>Check if header <code>hformat</code> is currently supported (both manually and using <code>auto_header</code>).</p> <p>Result is shown as a string.</p> <p>Parameters:</p> Name Type Description Default <code>hformat</code> <code>str</code> <p>Information message.</p> required Example <p>Check if format <code>'%y-%m-%d, %H:%M - %name:'</code> is supported.</p> <p>.. code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk.whatsapp.hformat import is_supported_verbose\n&gt;&gt;&gt; is_supported_verbose('%y-%m-%d, %H:%M - %name:')\n\"The header '%y-%m-%d, %H:%M - %name:' is supported. `auto_header` for this header is supported.\"\n</code></pre> Source code in <code>whatstk/whatsapp/hformat.py</code> <pre><code>def is_supported_verbose(hformat: str) -&gt; str:\n    \"\"\"Check if header `hformat` is currently supported (both manually and using `auto_header`).\n\n    Result is shown as a string.\n\n    Args:\n        hformat (str): Information message.\n\n\n    Example:\n            Check if format ``'%y-%m-%d, %H:%M - %name:'`` is supported.\n\n            .. code-block:: python\n\n                &gt;&gt;&gt; from whatstk.whatsapp.hformat import is_supported_verbose\n                &gt;&gt;&gt; is_supported_verbose('%y-%m-%d, %H:%M - %name:')\n                \"The header '%y-%m-%d, %H:%M - %name:' is supported. `auto_header` for this header is supported.\"\n\n    \"\"\"\n    support, auto_header_support = is_supported(hformat)\n\n    msg = \"The header '{}' is {}supported. `auto_header` for this header is {}supported.\".format(\n        hformat,\n        \"not \" if not support else \"\",\n        \"not \" if not auto_header_support else \"\",\n    )\n    return msg\n</code></pre>"},{"location":"reference/whatstk/whatsapp/objects/","title":"whatstk.whatsapp.objects","text":"<p>Library WhatsApp objects.</p>"},{"location":"reference/whatstk/whatsapp/objects/#whatstk.whatsapp.objects.WhatsAppChat","title":"<code>WhatsAppChat(df)</code>","text":"<p>               Bases: <code>BaseChat</code></p> <p>Load and process a WhatsApp chat file.</p> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Chat.</p> required Example <p>This simple example loads a chat using :func:<code>WhatsAppChat &lt;WhatsAppChat&gt;</code>. Once loaded, we can access its attribute :func:<code>df &lt;WhatsAppChat.df&gt;</code>, which contains the loaded chat as a DataFrame.</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk.whatsapp.objects import WhatsAppChat\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.POKEMON)\n&gt;&gt;&gt; chat.df.head(5)\n                 date     username                                            message\n0 2016-08-06 13:23:00  Ash Ketchum                                          Hey guys!\n1 2016-08-06 13:25:00        Brock              Hey Ash, good to have a common group!\n2 2016-08-06 13:30:00        Misty  Hey guys! Long time haven't heard anything fro...\n3 2016-08-06 13:45:00  Ash Ketchum  Indeed. I think having a whatsapp group nowada...\n4 2016-08-06 14:30:00        Misty                                          Definetly\n</code></pre> <p>Optionally, you can use the argument <code>extra_metadata</code> to add additional metadata to the chat:</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; chat = WhatsAppChat.from_source(filepath=whatsapp_urls.POKEMON, extra_metadata=True)\n&gt;&gt;&gt; chat.name\n'Pokemon Chat'\n&gt;&gt;&gt; chat.df_system\n                 date                                            message\n0   2016-04-15 15:04:00     Messages and calls are end-to-end encrypted. N...\n&gt;&gt;&gt; chat.df.head()\n                 date     username                                            message\n0 2016-08-06 13:23:00  Ash Ketchum                                          Hey guys!\n1 2016-08-06 13:25:00        Brock              Hey Ash, good to have a common group!\n2 2016-08-06 13:30:00        Misty  Hey guys! Long time haven't heard anything fro...\n3 2016-08-06 13:45:00  Ash Ketchum  Indeed. I think having a whatsapp group nowada...\n4 2016-08-06 14:30:00        Misty                                          Definetly\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>df</code> <code>DataFrame</code> <p>Chat.</p> required Source code in <code>whatstk/whatsapp/objects.py</code> <pre><code>def __init__(self, df: pd.DataFrame) -&gt; None:\n    \"\"\"Constructor.\n\n    Args:\n        df (pandas.DataFrame): Chat.\n\n    \"\"\"\n    super().__init__(df, platform=\"whatsapp\")\n</code></pre>"},{"location":"reference/whatstk/whatsapp/objects/#whatstk.whatsapp.objects.WhatsAppChat.from_source","title":"<code>from_source(filepath, extra_metadata=None, **kwargs)</code>  <code>classmethod</code>","text":"<p>Create an instance from a chat text file.</p> <p>Parameters:</p> Name Type Description Default <code>filepath</code> <code>str</code> <p>Path to the file. Accepted sources are:</p> <ul> <li>Local file, e.g. 'path/to/file.txt' or 'path/to/file.zip' (iOS).</li> <li>URL to a remote hosted file, e.g. 'http://www.url.to/file.txt'.</li> <li>Link to Google Drive file, e.g. 'gdrive://35gKKrNk-i3t05zPLyH4_P1rPdOmKW9NZ'. The format is expected   to be 'gdrive://[FILE-ID]'. Note that in order to load a file from Google Drive you first need to run   :func:<code>gdrive_init &lt;whatstk.utils.gdrive.gdrive_init&gt;</code>.</li> </ul> required <code>**kwargs</code> <code>Any</code> <p>Refer to the docs from         :func:<code>df_from_whatsapp &lt;whatstk.whatsapp.parser.df_from_whatsapp&gt;</code> for details on         additional arguments.</p> <code>{}</code> <code>extra_metadata</code> <code>bool</code> <p>This is experimental. If True, additional metadata will be added to the DataFrame.                     This includes class attributes such as chat.name, chat.df_system (DataFrame with                     only system messages). Note that this attribute only works on group chats.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>WhatsAppChat</code> <code>WhatsAppChat</code> <p>Class instance with loaded and parsed chat.</p> <p>..  seealso::</p> <pre><code>* :func:`df_from_whatsapp &lt;whatstk.whatsapp.parser.df_from_whatsapp&gt;`\n* :func:`WhatsAppChat.from_sources &lt;whatstk.WhatsAppChat.from_sources&gt;`\n</code></pre> Source code in <code>whatstk/whatsapp/objects.py</code> <pre><code>@classmethod\ndef from_source(\n    cls,\n    filepath: str,\n    extra_metadata: Optional[bool] = None,\n    **kwargs: Any  # noqa: ANN401\n) -&gt; \"WhatsAppChat\":\n    \"\"\"Create an instance from a chat text file.\n\n    Args:\n        filepath (str): Path to the file. Accepted sources are:\n\n            * Local file, e.g. 'path/to/file.txt' or 'path/to/file.zip' (iOS).\n            * URL to a remote hosted file, e.g. 'http://www.url.to/file.txt'.\n            * Link to Google Drive file, e.g. 'gdrive://35gKKrNk-i3t05zPLyH4_P1rPdOmKW9NZ'. The format is expected\n              to be 'gdrive://[FILE-ID]'. Note that in order to load a file from Google Drive you first need to run\n              :func:`gdrive_init &lt;whatstk.utils.gdrive.gdrive_init&gt;`.\n        **kwargs: Refer to the docs from\n                    :func:`df_from_whatsapp &lt;whatstk.whatsapp.parser.df_from_whatsapp&gt;` for details on\n                    additional arguments.\n        extra_metadata (bool): This is experimental. If True, additional metadata will be added to the DataFrame.\n                                This includes class attributes such as chat.name, chat.df_system (DataFrame with\n                                only system messages). Note that this attribute only works on group chats.\n\n    Returns:\n        WhatsAppChat: Class instance with loaded and parsed chat.\n\n    ..  seealso::\n\n        * :func:`df_from_whatsapp &lt;whatstk.whatsapp.parser.df_from_whatsapp&gt;`\n        * :func:`WhatsAppChat.from_sources &lt;whatstk.WhatsAppChat.from_sources&gt;`\n\n    \"\"\"\n    # Use extra metadata (label message types)\n    if extra_metadata:\n        warnings.warn(\n            (\n                \"The argument `extra_metadata` is an experimental feature that might become the default \"\n                \"in a future version. Set `extra_metadata=False` to keep current behavior. \"\n                \"The new behaviour will enables class attributes `chat.name` and `chat.df_system`. \"\n                \"Agian, this is very experimental, and has been mostly tested on iOS.\"\n            ),\n            FutureWarning,\n            stacklevel=2,\n        )\n        kwargs[\"message_type\"] = True\n    elif (extra_metadata is False) or (extra_metadata is None):\n        kwargs[\"message_type\"] = False\n    with warnings.catch_warnings():\n        warnings.simplefilter(\"ignore\")\n        df = df_from_whatsapp(filepath=filepath, **kwargs)\n\n    return cls(df)\n</code></pre>"},{"location":"reference/whatstk/whatsapp/objects/#whatstk.whatsapp.objects.WhatsAppChat.from_sources","title":"<code>from_sources(filepaths, auto_header=None, hformat=None, encoding='utf-8')</code>  <code>classmethod</code>","text":"<p>Load a WhatsAppChat instance from multiple sources.</p> <p>Parameters:</p> Name Type Description Default <code>filepaths</code> <code>list</code> <p>List with filepaths.</p> required <code>auto_header</code> <code>bool</code> <p>Detect header automatically (applies to all files). If None, attempts to                             perform automatic header detection for all files. If False, <code>hformat</code> is                             required.</p> <code>None</code> <code>hformat</code> <code>list</code> <p>List with the :ref:<code>header format &lt;The header format&gt;</code> to be used for each file.                         The list must be of length equal to <code>len(filenames)</code>. A valid header format                         might be '[%y-%m-%d %H:%M:%S] - %name:'.</p> <code>None</code> <code>encoding</code> <code>str</code> <p>Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).              <code>List of Python standard encodings              &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;</code>_.</p> <code>'utf-8'</code> <p>Returns:</p> Name Type Description <code>WhatsAppChat</code> <code>WhatsAppChat</code> <p>Class instance with loaded and parsed chat.</p> <p>..  seealso::</p> <pre><code>* :func:`WhatsAppChat.from_source &lt;WhatsAppChat.from_source&gt;`\n* :func:`merge_chats &lt;whatstk.utils.chat_merge.merge_chats&gt;`\n</code></pre> Example <p>Load a chat using two text files. In this example, we use sample chats (available online, see urls in source code :mod:<code>whatstk.data &lt;whatstk.data&gt;</code>).</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk.whatsapp.objects import WhatsAppChat\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; filepath_1 = whatsapp_urls.LOREM1\n&gt;&gt;&gt; filepath_2 = whatsapp_urls.LOREM2\n&gt;&gt;&gt; chat = WhatsAppChat.from_sources(filepaths=[filepath_1, filepath_2])\n&gt;&gt;&gt; chat.df.head(5)\n                 date        username                                            message\n0 2019-10-20 10:16:00            John        Laborum sed excepteur id eu cillum sunt ut.\n1 2019-10-20 11:15:00            Mary  Ad aliquip reprehenderit proident est irure mo...\n2 2019-10-20 12:16:00  +1 123 456 789  Nostrud adipiscing ex enim reprehenderit minim...\n3 2019-10-20 12:57:00  +1 123 456 789  Deserunt proident laborum exercitation ex temp...\n4 2019-10-20 17:28:00            John                Do ex dolor consequat tempor et ex.\n</code></pre> Source code in <code>whatstk/whatsapp/objects.py</code> <pre><code>@classmethod\ndef from_sources(\n    cls, filepaths: str, auto_header: Optional[bool] = None, hformat: Optional[str] = None, encoding: str = \"utf-8\"\n) -&gt; \"WhatsAppChat\":\n    \"\"\"Load a WhatsAppChat instance from multiple sources.\n\n    Args:\n        filepaths (list): List with filepaths.\n        auto_header (bool, optional): Detect header automatically (applies to all files). If None, attempts to\n                                        perform automatic header detection for all files. If False, ``hformat`` is\n                                        required.\n        hformat (list, optional): List with the :ref:`header format &lt;The header format&gt;` to be used for each file.\n                                    The list must be of length equal to ``len(filenames)``. A valid header format\n                                    might be '[%y-%m-%d %H:%M:%S] - %name:'.\n        encoding (str): Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).\n                         `List of Python standard encodings\n                         &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;`_.\n\n    Returns:\n        WhatsAppChat: Class instance with loaded and parsed chat.\n\n    ..  seealso::\n\n        * :func:`WhatsAppChat.from_source &lt;WhatsAppChat.from_source&gt;`\n        * :func:`merge_chats &lt;whatstk.utils.chat_merge.merge_chats&gt;`\n\n    Example:\n        Load a chat using two text files. In this example, we use sample chats (available online, see urls in\n        source code :mod:`whatstk.data &lt;whatstk.data&gt;`).\n\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk.whatsapp.objects import WhatsAppChat\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; filepath_1 = whatsapp_urls.LOREM1\n            &gt;&gt;&gt; filepath_2 = whatsapp_urls.LOREM2\n            &gt;&gt;&gt; chat = WhatsAppChat.from_sources(filepaths=[filepath_1, filepath_2])\n            &gt;&gt;&gt; chat.df.head(5)\n                             date        username                                            message\n            0 2019-10-20 10:16:00            John        Laborum sed excepteur id eu cillum sunt ut.\n            1 2019-10-20 11:15:00            Mary  Ad aliquip reprehenderit proident est irure mo...\n            2 2019-10-20 12:16:00  +1 123 456 789  Nostrud adipiscing ex enim reprehenderit minim...\n            3 2019-10-20 12:57:00  +1 123 456 789  Deserunt proident laborum exercitation ex temp...\n            4 2019-10-20 17:28:00            John                Do ex dolor consequat tempor et ex.\n\n    \"\"\"\n    dfs = []\n    if auto_header is None or auto_header:\n        auto_header = [True] * len(filepaths)\n    else:\n        auto_header = [False] * len(filepaths)\n    if hformat is None:\n        hformat = [None] * len(filepaths)\n    for filepath, ah, hf in zip(filepaths, auto_header, hformat):\n        chat = WhatsAppChat.from_source(filepath, auto_header=ah, hformat=hf, encoding=encoding)\n        dfs.append(chat.df)\n    df = merge_chats(dfs)\n    return cls(df)\n</code></pre>"},{"location":"reference/whatstk/whatsapp/objects/#whatstk.whatsapp.objects.WhatsAppChat.to_txt","title":"<code>to_txt(filepath, hformat=None, encoding='utf8')</code>","text":"<p>Export chat to a text file.</p> <p>Usefull to export the chat to different formats (i.e. using different hformats).</p> <p>Parameters:</p> Name Type Description Default <code>filepath</code> <code>str</code> <p>Name of the file to export (must be a local path).</p> required <code>hformat</code> <code>str</code> <p>Header format. Defaults to '%y-%m-%d, %H:%M - %name:'.</p> <code>None</code> <code>encoding</code> <code>str</code> <p>Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).              <code>List of Python standard encodings              &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;</code>_.</p> <code>'utf8'</code> Source code in <code>whatstk/whatsapp/objects.py</code> <pre><code>def to_txt(self, filepath: str, hformat: Optional[str] = None, encoding: str = \"utf8\") -&gt; None:\n    \"\"\"Export chat to a text file.\n\n    Usefull to export the chat to different formats (i.e. using different hformats).\n\n    Args:\n        filepath (str): Name of the file to export (must be a local path).\n        hformat (str, optional): Header format. Defaults to '%y-%m-%d, %H:%M - %name:'.\n        encoding (str, optional): Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).\n                         `List of Python standard encodings\n                         &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;`_.\n    \"\"\"\n    if not filepath.endswith(\".txt\"):\n        raise ValueError(f\"filepath {filepath} must end with .zip\")\n    if not hformat:\n        hformat = \"%y-%m-%d, %H:%M - %name:\"\n    text = _df_to_str(self.df, hformat)\n    with open(r\"{}\".format(filepath), \"w\", encoding=encoding) as f:\n        f.write(text)\n</code></pre>"},{"location":"reference/whatstk/whatsapp/objects/#whatstk.whatsapp.objects.WhatsAppChat.to_zip","title":"<code>to_zip(filepath, hformat=None, encoding='utf8')</code>","text":"<p>Export chat to a zip file.</p> <p>Usefull to export the chat to different formats (i.e. using different hformats).</p> <p>Parameters:</p> Name Type Description Default <code>filepath</code> <code>str</code> <p>Name of the file to export (must be a local path).</p> required <code>hformat</code> <code>str</code> <p>Header format. Defaults to '%y-%m-%d, %H:%M - %name:'.</p> <code>None</code> <code>encoding</code> <code>str</code> <p>Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).              <code>List of Python standard encodings              &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;</code>_.</p> <code>'utf8'</code> Source code in <code>whatstk/whatsapp/objects.py</code> <pre><code>def to_zip(self, filepath: str, hformat: Optional[str] = None, encoding: str = \"utf8\") -&gt; None:\n    \"\"\"Export chat to a zip file.\n\n    Usefull to export the chat to different formats (i.e. using different hformats).\n\n    Args:\n        filepath (str): Name of the file to export (must be a local path).\n        hformat (str, optional): Header format. Defaults to '%y-%m-%d, %H:%M - %name:'.\n        encoding (str, optional): Encoding to use for UTF when reading/writing (ex. \u2018utf-8\u2019).\n                         `List of Python standard encodings\n                         &lt;https://docs.python.org/3/library/codecs.html#standard-encodings&gt;`_.\n\n    \"\"\"\n    if not filepath.endswith(\".zip\"):\n        raise ValueError(f\"filepath {filepath} must end with .zip\")\n    if not hformat:\n        hformat = \"%y-%m-%d, %H:%M - %name:\"\n    text = _df_to_str(self.df, hformat)\n    text_filename = \"_chat.txt\"\n\n    # Create a temporary directory to hold the text file\n    with tempfile.TemporaryDirectory() as temp_dir:\n        text_file_path = os.path.join(temp_dir, text_filename)\n\n        # Write the string to a temporary text file\n        with open(text_file_path, 'w', encoding=encoding) as text_file:\n            text_file.write(text)\n\n        # Create a zip file and add the text file to it\n        with zipfile.ZipFile(filepath, 'w', zipfile.ZIP_DEFLATED) as zipf:\n            zipf.write(text_file_path, text_filename)\n</code></pre>"},{"location":"reference/whatstk/whatsapp/parser/","title":"whatstk.whatsapp.parser","text":"<p>Parser utils.</p>"},{"location":"reference/whatstk/whatsapp/parser/#whatstk.whatsapp.parser.df_from_txt_whatsapp","title":"<code>df_from_txt_whatsapp(filepath, **kwargs)</code>","text":"<p>Alias for :func:<code>df_from_whatsapp &lt;whatstk.whatsapp.parser.df_from_whatsapp&gt;</code>.</p> Source code in <code>whatstk/whatsapp/parser.py</code> <pre><code>def df_from_txt_whatsapp(filepath: str, **kwargs: Any) -&gt; pd.DataFrame:  # noqa: ANN401\n    \"\"\"Alias for :func:`df_from_whatsapp &lt;whatstk.whatsapp.parser.df_from_whatsapp&gt;`.\"\"\"\n    warnings.warn(\n        \"This function is deprecated and will be removed in future versions. Use `df_from_whatsapp` instead.\",\n        FutureWarning,\n        stacklevel=2,\n    )\n    return df_from_whatsapp(filepath, **kwargs)\n</code></pre>"},{"location":"reference/whatstk/whatsapp/parser/#whatstk.whatsapp.parser.df_from_whatsapp","title":"<code>df_from_whatsapp(filepath, auto_header=True, hformat=None, encoding='utf-8', message_type=None)</code>","text":"<p>Load chat as a DataFrame.</p> <p>Parameters:</p> Name Type Description Default <code>filepath</code> <code>str</code> <p>Path to the file. Accepted sources are:</p> <pre><code>* Local file, e.g. 'path/to/file.txt' OR 'path/to/_chat.zip' (e.g. iOS export).\n* URL to a remote hosted file, e.g. 'http://www.url.to/file.txt'.\n* Link to Google Drive file, e.g. 'gdrive://35gKKrNk-i3t05zPLyH4_P1rPdOmKW9NZ'. The format is expected\n  to be 'gdrive://[FILE-ID]'. Note that in order to load a file from Google Drive you first need to run\n  :func:`gdrive_init &lt;whatstk.utils.gdrive.gdrive_init&gt;`.\n</code></pre> required <code>auto_header</code> <code>bool</code> <p>Detect header automatically. If False, <code>hformat</code> is required.</p> <code>True</code> <code>hformat</code> <code>str</code> <p>:ref:<code>Format of the header &lt;The header format&gt;</code>, e.g.                         <code>'[%y-%m-%d %H:%M:%S] - %name:'</code>. Use following keywords:</p> <pre><code>                    - ``'%y'``: for year (``'%Y'`` is equivalent).\n                    - ``'%m'``: for month.\n                    - ``'%d'``: for day.\n                    - ``'%H'``: for 24h-hour.\n                    - ``'%I'``: for 12h-hour.\n                    - ``'%M'``: for minutes.\n                    - ``'%S'``: for seconds.\n                    - ``'%P'``: for \"PM\"/\"AM\" or \"p.m.\"/\"a.m.\" characters.\n                    - ``'%name'``: for the username.\n\n                    Example 1: For the header '12/08/2016, 16:20 - username:' we have the\n                    ``'hformat='%d/%m/%y, %H:%M - %name:'``.\n\n                    Example 2: For the header '2016-08-12, 4:20 PM - username:' we have\n                    ``hformat='%y-%m-%d, %I:%M %P - %name:'``.\n</code></pre> <code>None</code> <code>encoding</code> <code>str</code> <p>Encoding to use for UTF when reading/writing (ex. 'utf-8').                       <code>List of Python standard encodings &lt;https://docs.python.org/3/library/codecs.                       html#standard-encodings&gt;</code>_.</p> <code>'utf-8'</code> <code>message_type</code> <code>bool</code> <p>Label for the message type. Can be 'user' or 'system', based on                             who sent the message.</p> <code>None</code> <p>Returns:</p> Name Type Description <code>WhatsAppChat</code> <code>DataFrame</code> <p>Class instance with loaded and parsed chat.</p> Example <p>Read a chat</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import df_from_whatsapp\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; df = df_from_whatsapp(filepath=whatsapp_urls.LOREM)\n&gt;&gt;&gt; df.head(5)\n                 date        username                                            message    message_type\n0 2020-01-15 02:22:56            Mary                     Nostrud exercitation magna id.          system\n1 2020-01-15 03:33:01            Mary     Non elit irure irure pariatur exercitation. \ud83c\udde9\ud83c\uddf0            user\n2 2020-01-15 04:18:42  +1 123 456 789  Exercitation esse lorem reprehenderit ut ex ve...            user\n3 2020-01-15 06:05:14        Giuseppe  Aliquip dolor reprehenderit voluptate dolore e...            user\n4 2020-01-15 06:56:00            Mary              Ullamco duis et commodo exercitation.            user\n</code></pre> <p>Read a chat, labelling each message as 'user' or 'system'. 'system' messages are those sent by the chat itself (creation of chat, etc.)</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk import df_from_whatsapp\n&gt;&gt;&gt; from whatstk.data import whatsapp_urls\n&gt;&gt;&gt; df = df_from_whatsapp(filepath=whatsapp_urls.POKEMON, message_type=True)\n&gt;&gt;&gt; df.head()\n\n                 date        username                                            message    message_type\n0 2016-04-15 15:04:00    Pokemon Chat  Messages and calls are end-to-end encrypted. N...          system\n1 2016-08-06 13:23:00     Ash Ketchum                                          Hey guys!            user\n2 2016-08-06 13:25:00           Brock              Hey Ash, good to have a common group!            user\n3 2016-08-06 13:30:00           Misty  Hey guys! Long time since heard anything from you            user\n</code></pre> <p>..  seealso::</p> <pre><code>* :func:`WhatsAppChat.from_source &lt;whatstk.whatsapp.objects.WhatsAppChat.from_source&gt;`\n* :func:`extract_header_from_text &lt;whatstk.whatsapp.auto_header.extract_header_from_text&gt;`\n* :func:`gdrive_init &lt;whatstk.utils.gdrive.gdrive_init&gt;`\n</code></pre> Source code in <code>whatstk/whatsapp/parser.py</code> <pre><code>def df_from_whatsapp(\n    filepath: str,\n    auto_header: bool = True,\n    hformat: Optional[str] = None,\n    encoding: str = \"utf-8\",\n    message_type: Optional[bool] = None,\n) -&gt; pd.DataFrame:\n    \"\"\"Load chat as a DataFrame.\n\n    Args:\n        filepath (str): Path to the file. Accepted sources are:\n\n                * Local file, e.g. 'path/to/file.txt' OR 'path/to/_chat.zip' (e.g. iOS export).\n                * URL to a remote hosted file, e.g. 'http://www.url.to/file.txt'.\n                * Link to Google Drive file, e.g. 'gdrive://35gKKrNk-i3t05zPLyH4_P1rPdOmKW9NZ'. The format is expected\n                  to be 'gdrive://[FILE-ID]'. Note that in order to load a file from Google Drive you first need to run\n                  :func:`gdrive_init &lt;whatstk.utils.gdrive.gdrive_init&gt;`.\n        auto_header (bool, optional): Detect header automatically. If False, ``hformat`` is required.\n        hformat (str, optional): :ref:`Format of the header &lt;The header format&gt;`, e.g.\n                                    ``'[%y-%m-%d %H:%M:%S] - %name:'``. Use following keywords:\n\n                                    - ``'%y'``: for year (``'%Y'`` is equivalent).\n                                    - ``'%m'``: for month.\n                                    - ``'%d'``: for day.\n                                    - ``'%H'``: for 24h-hour.\n                                    - ``'%I'``: for 12h-hour.\n                                    - ``'%M'``: for minutes.\n                                    - ``'%S'``: for seconds.\n                                    - ``'%P'``: for \"PM\"/\"AM\" or \"p.m.\"/\"a.m.\" characters.\n                                    - ``'%name'``: for the username.\n\n                                    Example 1: For the header '12/08/2016, 16:20 - username:' we have the\n                                    ``'hformat='%d/%m/%y, %H:%M - %name:'``.\n\n                                    Example 2: For the header '2016-08-12, 4:20 PM - username:' we have\n                                    ``hformat='%y-%m-%d, %I:%M %P - %name:'``.\n        encoding (str, optional): Encoding to use for UTF when reading/writing (ex. 'utf-8').\n                                  `List of Python standard encodings &lt;https://docs.python.org/3/library/codecs.\n                                  html#standard-encodings&gt;`_.\n        message_type (bool, optional): Label for the message type. Can be 'user' or 'system', based on\n                                        who sent the message.\n\n    Returns:\n        WhatsAppChat: Class instance with loaded and parsed chat.\n\n    Example:\n        Read a chat\n\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk import df_from_whatsapp\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; df = df_from_whatsapp(filepath=whatsapp_urls.LOREM)\n            &gt;&gt;&gt; df.head(5)\n                             date        username                                            message    message_type\n            0 2020-01-15 02:22:56            Mary                     Nostrud exercitation magna id.          system\n            1 2020-01-15 03:33:01            Mary     Non elit irure irure pariatur exercitation. \ud83c\udde9\ud83c\uddf0            user\n            2 2020-01-15 04:18:42  +1 123 456 789  Exercitation esse lorem reprehenderit ut ex ve...            user\n            3 2020-01-15 06:05:14        Giuseppe  Aliquip dolor reprehenderit voluptate dolore e...            user\n            4 2020-01-15 06:56:00            Mary              Ullamco duis et commodo exercitation.            user\n\n        Read a chat, labelling each message as 'user' or 'system'. 'system' messages are those sent by the chat itself\n        (creation of chat, etc.)\n\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk import df_from_whatsapp\n            &gt;&gt;&gt; from whatstk.data import whatsapp_urls\n            &gt;&gt;&gt; df = df_from_whatsapp(filepath=whatsapp_urls.POKEMON, message_type=True)\n            &gt;&gt;&gt; df.head()\n\n                             date        username                                            message    message_type\n            0 2016-04-15 15:04:00    Pokemon Chat  Messages and calls are end-to-end encrypted. N...          system\n            1 2016-08-06 13:23:00     Ash Ketchum                                          Hey guys!            user\n            2 2016-08-06 13:25:00           Brock              Hey Ash, good to have a common group!            user\n            3 2016-08-06 13:30:00           Misty  Hey guys! Long time since heard anything from you            user\n\n\n\n    ..  seealso::\n\n        * :func:`WhatsAppChat.from_source &lt;whatstk.whatsapp.objects.WhatsAppChat.from_source&gt;`\n        * :func:`extract_header_from_text &lt;whatstk.whatsapp.auto_header.extract_header_from_text&gt;`\n        * :func:`gdrive_init &lt;whatstk.utils.gdrive.gdrive_init&gt;`\n\n    \"\"\"\n    # Read local file\n    text = _str_from_file(filepath, encoding)\n\n    # Clean text from unwanted unicode characters\n    text = _clean_text(text)\n\n    # Build dataframe\n    df = _df_from_str(text, auto_header, hformat)\n\n    # Raise FutureWarning\n    if message_type is None:\n        message_type = False\n    # Add message type only if num users &gt; 2\n    if message_type:\n        warnings.warn(\n            (\n                \"The argument `extra_metadata` is an experimental feature that might become the default \"\n                \"in a future version. Set `extra_metadata=False` to keep current behavior. \"\n                \"The new behaviour will enables class attributes `chat.name` and `chat.df_system`. \"\n                \"Agian, this is very experimental, and has been mostly tested on iOS.\"\n            ),\n            FutureWarning,\n            stacklevel=2,\n        )\n        if len(set(df[\"username\"])) &gt; 2:\n            chat_name = df[\"username\"].iloc[0]\n            df[\"message_type\"] = df[\"username\"].apply(\n                lambda x: \"user\" if x != chat_name else \"system\"\n            )\n        else:\n            df[\"message_type\"] = \"user\"\n    return df\n</code></pre>"},{"location":"reference/whatstk/whatsapp/parser/#whatstk.whatsapp.parser.generate_regex","title":"<code>generate_regex(hformat)</code>","text":"<p>Generate regular expression from hformat.</p> <p>Parameters:</p> Name Type Description Default <code>hformat</code> <code>str</code> <p>Simplified syntax for the header, e.g. <code>'%y-%m-%d, %H:%M:%S - %name:'</code>.</p> required <p>Returns:</p> Name Type Description <code>str</code> <code>Tuple[str, str]</code> <p>Regular expression corresponding to the specified syntax.</p> Example <p>Generate regular expression corresponding to <code>'hformat=%y-%m-%d, %H:%M:%S - %name:'</code>.</p> <p>..  code-block:: python</p> <pre><code>&gt;&gt;&gt; from whatstk.whatsapp.parser import generate_regex\n&gt;&gt;&gt; generate_regex('%y-%m-%d, %H:%M:%S - %name:')\n('(?P&lt;year&gt;\\\\d{2,4})-(?P&lt;month&gt;\\\\d{1,2})-(?P&lt;day&gt;\\\\d{1,2}), (?P&lt;hour&gt;\\\\d{1,2}):(?P&lt;minutes&gt;\\\\d{2}):(?\nP&lt;seconds&gt;\\\\d{2}) - (?P&lt;username&gt;[^:]*): ', '(?P&lt;year&gt;\\\\d{2,4})-(?P&lt;month&gt;\\\\d{1,2})-(?P&lt;day&gt;\\\\d{1,2}), (?\nP&lt;hour&gt;\\\\d{1,2}):(?P&lt;minutes&gt;\\\\d{2}):(?P&lt;seconds&gt;\\\\d{2}) - ')\n</code></pre> Source code in <code>whatstk/whatsapp/parser.py</code> <pre><code>def generate_regex(hformat: str) -&gt; Tuple[str, str]:\n    r\"\"\"Generate regular expression from hformat.\n\n    Args:\n        hformat (str): Simplified syntax for the header, e.g. ``'%y-%m-%d, %H:%M:%S - %name:'``.\n\n    Returns:\n        str: Regular expression corresponding to the specified syntax.\n\n    Example:\n        Generate regular expression corresponding to ``'hformat=%y-%m-%d, %H:%M:%S - %name:'``.\n\n        ..  code-block:: python\n\n            &gt;&gt;&gt; from whatstk.whatsapp.parser import generate_regex\n            &gt;&gt;&gt; generate_regex('%y-%m-%d, %H:%M:%S - %name:')\n            ('(?P&lt;year&gt;\\\\d{2,4})-(?P&lt;month&gt;\\\\d{1,2})-(?P&lt;day&gt;\\\\d{1,2}), (?P&lt;hour&gt;\\\\d{1,2}):(?P&lt;minutes&gt;\\\\d{2}):(?\n            P&lt;seconds&gt;\\\\d{2}) - (?P&lt;username&gt;[^:]*): ', '(?P&lt;year&gt;\\\\d{2,4})-(?P&lt;month&gt;\\\\d{1,2})-(?P&lt;day&gt;\\\\d{1,2}), (?\n            P&lt;hour&gt;\\\\d{1,2}):(?P&lt;minutes&gt;\\\\d{2}):(?P&lt;seconds&gt;\\\\d{2}) - ')\n\n    \"\"\"\n    items = re.findall(r\"\\%\\w*\", hformat)\n    for i in items:\n        hformat = hformat.replace(i, regex_simplifier[i])\n\n    hformat = hformat + \" \"\n    hformat_x = hformat.split(\"(?P&lt;username&gt;[^:]*)\")[0]\n    return hformat, hformat_x\n</code></pre>"},{"location":"reference/whatstk/whatsapp/assets/","title":"whatstk.whatsapp.assets","text":"<p>Static assets.</p>"}]}